<html>
<head>
<title>Deployment Instruction - Stage</title>
</head>
<body>
<h1>Deployment Instruction - Stage</h1>
    <h2>Install PostgreSQL &amp; Configure</h2>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>root</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:root) create user memfis (type in password after execution)</p>
            <div style="background-color:silver;"><code># adduser memfis</code></div></li>
        <li><p>(ssh:clbtpsql01:root) set password for the user using the following command:</p>
            <div style="background-color:silver;"><code># passwd memfis</code></div></li>
        <li><p>(ssh:clbtpsql01:root) modify <b>/etc/ssh/sshd_config</b></p>
            <div style="background-color:silver;"><code>>>>START the following line:<br/>
<font color="red">#</font>PermitRootLogin no<br/>
>>> FINISH<br/></code></div>
<br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>>START <b>/etc/ssh/sshd_config</b><br/>
PermitRootLogin <font color="red">no</font><br/>
>>> FINISH<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:root) restart sshd service using the following command</p>
            <div style="background-color:silver;"><code># systemctl restart sshd.service</code></div></li>
        <li><p>(ssh:clbtpsql01:root) update yum using the following command:</p>
            <div style="background-color:silver;"><code># yum update</code></div></li>
        <li><p>(ssh:clbtpsql01:root) install postgresql using the following command:</p>
            <div style="background-color:silver;"><code># yum install postgresql-server postgresql-contrib</code></div></li>
        <li><p>(ssh:clbtpsql01:root) install net-tools (for ifconfig etc.) using the following command:</p>
            <div style="background-color:silver;"><code># yum install net-tools</code></div></li>
        <li><p>(ssh:clbtpsql01:root) initialize postgresql database using the following command:</p>
            <div style="background-color:silver;"><code># postgresql-setup initdb</code></div></li>
        <li><p>(ssh:clbtpsql01:root) allow to run postgresql service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl enable postgresql</code></div></li>
        <li><p>(ssh:clbtpsql01:root) run postgresql service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl start postgresql</code></div></li>
        <li><p>(ssh:clbtpsql01:root) <a id="clbtpsql01_external_ip">check external ip the following command</a>:</p>
            <div style="background-color:silver;"><code># ifconfig -a</code></div></li>
        <li><p>(ssh:clbtpsql01:root) modify <b>/var/lib/pgsql/data/postgresql.conf</b> (<a href="#clbtpsql01_external_ip">requires external ip</a>)</p>
            <div style="background-color:silver;"><code>>>> START the following line<br/>
<font color="red">#</font>listen_addresses = '<font color="red">localhost</font>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# what IP address(es) to listen on;<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /var/lib/pgsql/data/postgresql.conf<br/>
listen_addresses = '<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# what IP address(es) to listen on;<br/>
>>> FINISH</code></div>
</li>
        <li><p>(ssh:clbtpsql01:root) modify <b>/var/lib/pgsql/data/pg_hba.conf</b></p>
            <div style="background-color:silver;"><code>>>> START the following line<br/>
local&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">peer</font><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /var/lib/pgsql/data/pg_hba.conf<br/>
local&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">trust</font><br/>
>>> FINISH</code></div>
</li>
        <li><p>(ssh:clbtpsql01:root) restart postgresql using the following command (<i>on custom version of progres the service name will be different, use "systemctl list-units | grep post" to get actual name</i>):</p>
            <div style="background-color:silver;"><code># service postgresql.service restart</code></div></li>
        <li><p>(ssh:clbtpsql01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) login into postgresql shell using the following command:</p>
            <div style="background-color:silver;"><code>$ psql -U postgres</code></div></li>
        <li><p>(psql:clbtpsql01:postgres) <a id="psql_postgres_password">reset password for postgres user using the following SQL command:</a></p>
            <div style="background-color:silver;"><code>postgres=# ALTER USER postgres WITH PASSWORD '<font color="red">&lt;password&gt;</font>';</code></div></li>
        <li><p>(psql:clbtpsql01:postgres) exit from postgresql using the following command:</p>
            <div style="background-color:silver;"><code>postgres=# \q</code></div></li>
        <li><p>(ssh:clbtpsql01:root) modify <b>/var/lib/pgsql/data/pg_hba.conf</b></p>
            <div style="background-color:silver;"><code>>>> START the following line<br/>
local&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trust<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;127.0.0.1/32&nbsp;&nbsp;ident<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;::1/128&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ident<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>
>>> START /var/lib/pgsql/data/pg_hba.conf<br/>
local&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">md5</font><br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;127.0.0.1/32&nbsp;&nbsp;<font color="red">md5</font><br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;::1/128&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">md5</font><br/>
<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtpsql01:root) restart postgresql using the following command:</p>
            <div style="background-color:silver;"><code># service postgresql.service restart</code></div></li>
        <li><p>(ssh:clbtpsql01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) try to login to postgresql shell using the following command (<a href="#psql_postgres_password">requires password</a>):</p>
            <div style="background-color:silver;"><code>$ psql -U postgres -W</code></div></li>
        <li><p>(psql:clbtpsql01:postgres) exit from postgresql using the following command:</p>
            <div style="background-color:silver;"><code>postgres=# \q</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) create directory for postgresql scripts, using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-model/psql/_initial-1.sql<br/>
/colaba_back/clb-parent/clb-model/psql/_initial-2.sql<br/>
/colaba_back/clb-parent/clb-model/psql/alter-0.0.1-1.sql<br/>
/colaba_back/clb-parent/clb-model/psql/alter-0.0.1-2.sql<br/>
/colaba_back/clb-parent/clb-model/psql/alter-0.0.1-3.sql<br/>
/colaba_back/clb-parent/clb-model/psql/alter-0.0.1-4.sql<br/>
/colaba_back/clb-parent/clb-model/psql/alter-2.0.0-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) <a id="psql_hibernate_password">modify <b>/home/memfis/psql/_initial-1.sql</b></a>:</p>
            <div style="background-color:silver;"><code>>>> START the following line:<br/>
CREATE USER hibernate WITH ENCRYPTED PASSWORD '121212';<br/>
>>> FINISH<br/></code></div><br/>
to<br/>
<div style="background-color:silver;"><code>>>> START /home/memfis/psql/_initial-1.sql:<br/>
CREATE USER hibernate WITH ENCRYPTED PASSWORD '<font color="red">&lt;actual_password&gt;</font>';<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (require <a href="#psql_postgres_password">password of postgres</a> user on first step and <a href="#psql_hibernate_password">password for hibernate</a> user the next commands)</p>
            <div style="background-color:silver;"><code>$ psql -U postgres -d postgres -a -f _initial-1.sql<br/>
$ psql -U hibernate -d clb -a -f _initial-2.sql<br/>
$ psql -U hibernate -d clb -a -f alter-0.0.1-1.sql<br/>
$ psql -U hibernate -d clb -a -f alter-0.0.1-2.sql<br/>
$ psql -U hibernate -d clb -a -f alter-0.0.1-3.sql<br/>
$ psql -U hibernate -d clb -a -f alter-0.0.1-4.sql<br/>
$ psql -U hibernate -d clb -a -f alter-2.0.0-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtpsql01:root) add firewall rule for tomcat on clbttmct01, to allow it to connect to the psql service using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32" port protocol="tcp" port="5432" accept'</code></div></li>
        <li><p>(ssh:clbtpsql01:root) add firewall rule for tomcat on clbttmct02, to allow it to connect to the psql service using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32" port protocol="tcp" port="5432" accept'</code></div></li>
        <li><p>(ssh:clbtpsql01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>
    <h2>Install MariaDB &amp; Configure</h2>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>root</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:root) create user memfis (type in password after execution)</p>
            <div style="background-color:silver;"><code># adduser memfis</code></div></li>
        <li><p>(ssh:clbtmari01:root) set password for the user using the following command:</p>
            <div style="background-color:silver;"><code># passwd memfis</code></div></li>
        <li><p>(ssh:clbtmari01:root) modify <b>/etc/ssh/sshd_config</b></p>
            <div style="background-color:silver;"><code>>>>START the following line:<br/>
<font color="red">#</font>PermitRootLogin no<br/>
>>> FINISH<br/></code></div>
<br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>>START <b>/etc/ssh/sshd_config</b><br/>
PermitRootLogin <font color="red">no</font><br/>
>>> FINISH<br/></code></div></li>
        <li><p>(ssh:clbtmari01:root) restart sshd service using the following command</p>
            <div style="background-color:silver;"><code># systemctl restart sshd.service</code></div></li>
        <li><p>(ssh:clbtmari01:root) update yum using the following command:</p>
            <div style="background-color:silver;"><code># yum update</code></div></li>
        <li><p>(ssh:clbtmari01:root) install MariaDB using the following command:</p>
            <div style="background-color:silver;"><code># yum install mariadb-server</code></div></li>
        <li><p>(ssh:clbtmari01:root) modify <b>/etc/my.cnf file</b>, <font color="red">after "socket" key </font> insert the following line:</p>
            <div style="background-color:silver;"><code>>>> START /etc/my.cnf<br/>
bind=<font color="red">&lt;external_ip_of_clbtmari01&gt;</font><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:root) allow to run mariadb service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl enable mariadb</code></div></li>
        <li><p>(ssh:clbtmari01:root) run mariadb service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl start mariadb</code></div></li>
        <li><p>(ssh:clbtmari01:root) login to mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code># mysql</code></div></li>
        <li><p>(mysql:clbtmari01) <a id="maria_memfis_password">add <b>memfis</b> user in mariadb using the following commands (password must be same on all commands):</a></p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> CREATE USER 'memfis'@'localhost' IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';</code></div></li>
        <li><p>(mysql:clbtmari01) grant all priveleges to memfis user in mariadb using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> GRANT ALL PRIVILEGES ON *.* TO 'memfis'@'localhost' WITH GRANT OPTION;</code></div></li>
        <li><p>(mysql:clbtmari01) exit from mariadb using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
        <li><p>(ssh:clbtmari01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) cd directory to home using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) create directory for cql scripts:</p>
            <div style="background-color:silver;"><code>$ mkdir mysql</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/mysql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-model/mysql/_initial.sql<br/>
/colaba_back/clb-parent/clb-chat-parent/clb-chat-model/mysql/alter-2.0.0-1.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) inside _initial.sql change password of hibernate user:</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/mysql/_initial.sql<br/>
CREATE USER hibernate IDENTIFIED BY '121212';<br/>
GRANT ALL PRIVILEGES ON clb_chat.* to hibernate@'%' IDENTIFIED BY '121212';<br/>
GRANT ALL PRIVILEGES ON clb_chat.* to hibernate@'localhost' IDENTIFIED BY '121212';<br/>
>>> FINISH</code></div>
to
<div style="background-color:silver;"><code>>>> START /home/memfis/mysql/_initial.sql<br/>
CREATE USER hibernate IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';<br/>
GRANT ALL PRIVILEGES ON clb_chat.* to hibernate@'<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>' IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';<br/>
GRANT ALL PRIVILEGES ON clb_chat.* to hibernate@'<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>' IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';<br/>
GRANT ALL PRIVILEGES ON clb_chat.* to hibernate@'localhost' IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>~/mysql/</b> using the following command</p>
            <div style="background-color:silver;"><code>$ cd mysql/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>_initial.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/_initial.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change charset of clb_chat to 'utf8mb4' using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> ALTER DATABASE clb_chat CHARACTER SET = 'utf8mb4';</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_chat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_chat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>alter-2.0.0-1.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [clb_chat]> source /home/memfis/mysql/alter-2.0.0-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [clb_chat]> exit;</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change current account back to the root</p>
            <div style="background-color:silver;"><code>$ exit</code></div></li>
        <li><p>(ssh:clbtmari01:root) add firewall rules for active mq openwire port for tomcat servers using the following commands:</p>
            <div style="background-color:silver;"><code>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32" port protocol="tcp" port="3306" accept'<br/>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32" port protocol="tcp" port="3306" accept'</code></div></li>
        <li><p>(ssh:clbtmari01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
        
    </ol>
    <h2>Install Apache ActiveMQ &amp; Configure</h2>
    <ol>
        <li><p>login on <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtmari01:root) create directory /app using the following command:</p>
            <div style="background-color:silver;"><code># mkdir /app</code></div></li>
        <li><p>(ssh:clbtmari01:root) change owner of the /app directory to memfis using the following command:</p>
            <div style="background-color:silver;"><code># chown memfis:memfis /app</code></div></li>
        <li><p>(ssh:clbtmari01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /app, using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) create directory for java installations using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir java</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /app/java using the following command:</p>
            <div style="background-color:silver;"><code>$ cd java</code></div></li>
        <li><p>download openjdk 11 from official openjdk website (tar.gz)</p></li>
        <li><p>using any sftp client upload jdk to /app/java directory</p></li>
        <li><p>(ssh:clbtmari01:memfis) unpack jdk 11 using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -zxf <font color="red">&lt;JDK11&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete jdk distribution:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;JDK11&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to home using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>modify .bash_profile file to add the following lines <b>BEFORE "export PATH"</b> of the file (modify paths according to your dir names!!!):</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/.bash_profile<br>
<br/>
export JAVA_HOME=/app/java/<font color="red">&lt;jdk_11_home&gt;</font><br/>
PATH="$JAVA_HOME/bin:$PATH"<br/>
<br/>
>>> FINISH
            </code></div></li>
        <li><p>(ssh:clbtmari01:memfis) logout from SSH to have system vars on next SSH session using the following command:</p>
            <div style="background-color:silver;"><code>$ exit</code></div></li>
        <li><p>login on <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) create directory for apache active mq using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir activemq/</code></div></li>
        <li><p>download apache active mq for linux from <a href="https://activemq.apache.org/components/classic/download/">offical website</a></p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>upload *.<b>tar.gz</b> distr of activemq to the box into <b>/app/activemq/</b> via sftp using memfis account.</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/activemq/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/activemq/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) unpack tar.gz distr of apache activemq using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -xzf <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete tar.gz distr of apache activemq using the following command:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to conf directory of apache activemq</p>
            <div style="background-color:silver;"><code>$ cd <font color="red">&lt;activemq_home&gt;</font>/conf/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>activemq.xml</b>: change network interface only</p>
            <div style="background-color:silver;"><code>>>> START the following lines:<br/>
&lt;transportConnector name="amqp" uri="amqp://0.0.0.0:5672?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
&lt;transportConnector name="stomp" uri="stomp://0.0.0.0:61613?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
&lt;transportConnector name="mqtt" uri="mqtt://0.0.0.0:1883?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
&lt;transportConnector name="ws" uri="ws://0.0.0.0:61614?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
>>> FINISH<br/></code></div>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/activemq/<font color="red">&lt;activemq_home&gt;</font>/conf/activemq.xml<br/>
&lt;transportConnector name="amqp" uri="amqp://<font color="red">127.0.0.1</font>:5672?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
&lt;transportConnector name="stomp" uri="stomp://<font color="red">127.0.0.1</font>:61613?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
&lt;transportConnector name="mqtt" uri="mqtt://<font color="red">127.0.0.1</font>:1883?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
&lt;transportConnector name="ws" uri="ws://<font color="red">127.0.0.1</font>:61614?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600"/&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>users.properties</b>: <a id="activemq_clb1_password">add user clb1 instead of the default one</a></p>
            <div style="background-color:silver;"><code>>>> START /app/activemq/<font color="red">&lt;activemq_home&gt;</font>/config/conf/users.properties<br/>
admin=admin<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/activemq/<font color="red">&lt;activemq_home&gt;</font>/config/conf/users.properties<br/>
clb1=<font color="red">&lt;your_password></font><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>activemq.xml</b>: add the following text as <b>LAST</b> child elements of <b>/beans/broker</b> element (<a href="#activemq_clb1_password">requires password</a>)</p>
            <div style="background-color:silver;"><code>>>> START /app/activemq/<font color="red">&lt;activemq_home&gt;</font>/config/conf/activemq.xml<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;plugins><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;simpleAuthenticationPlugin><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;users><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;authenticationUser username="clb1" password="<font color="red">&lt;your_password></font>" groups=""/><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/users><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/simpleAuthenticationPlugin><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plugins><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) <a id="activemq_web_console_creds">modify <b>jetty-realm.properties</b></a></p>
            <div style="background-color:silver;"><code>>>> START the following lines:<br/>
admin: admin, admin<br/>
user: user, user<br/>
>>> FINISH<br/></code></div>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>
>>> START /app/activemq/<font color="red">&lt;activemq_home&gt;</font>/conf/jetty-realm.properties<br/>
<font color="red">mqsupadmin: &lt;password&gt;, admin</font><br/>
>>> FINISH
</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to bin directory of apache activemq using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ../bin/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtmari01:root) add firewall rule for active mq web-admin console port for our office IP using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_your_office&gt;</font>/32" port protocol="tcp" port="8161" accept'</code></div></li>
        <li><p>(ssh:clbtmari01:root) add firewall rule for active mq openwire port for tomcat servers using the following commands:</p>
            <div style="background-color:silver;"><code>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32" port protocol="tcp" port="61616" accept'<br/>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32" port protocol="tcp" port="61616" accept'</code></div></li>
        <li><p>(ssh:clbtmari01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
        <li><p>(ssh:clbtmari01:root) create file <b>/etc/systemd/system/activemq.service</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /etc/systemd/system/activemq.service<br/>
[Unit]<br/>
Description=ActiveMQ<br/>
<br/>
[Service]<br/>
Type=forking<br/>
LimitNOFILE=65535<br/>
PIDFile=/app/activemq/apache-activemq-5.15.9/data/activemq.pid<br/>
WorkingDirectory=/app/activemq/apache-activemq-5.15.9/bin<br/>
<br/>
User=memfis<br/>
Group=memfis<br/>
<br/>
OOMScoreAdjust=-100<br/>
<br/>
Environment=JAVA_HOME=/app/java/jdk-11.0.2<br/>
<br/>
ExecStart=/app/activemq/apache-activemq-5.15.9/bin/activemq start<br/>
ExecStop=/app/activemq/apache-activemq-5.15.9/bin/activemq stop<br/>
ExecReload=/app/activemq/apache-activemq-5.15.9/bin/activemq restart<br/>
TimeoutSec=300<br/>
<br/>
[Install]<br/>
WantedBy=multi-user.target<br/>
>>> FINISH<br/>
</code></div>
<div style="background-color:gray;"><p>Note: if you <font color="yellow">made</font> mistake in the service script, you can modify it using the following command:</p>
<code>systemctl edit --full activemq</code></div></li>
            <li><p>(ssh:clbtmari01:root) check status of the service script</p>
                <div style="background-color:silver;"><code># systemctl status activemq</code></div></li>
            <li><p>(ssh:clbtmari01:root) output of the command above must be the following:</p>
                <div style="background-color:silver;"><code>activemq.service - ActiveMQ<br/>
&nbsp;&nbsp;Loaded: loaded (/etc/systemd/system/activemq.service; disabled)<br/>
&nbsp;&nbsp;Active: inactive (dead)</code></div></li>
            <li><p>(ssh:clbtmari01:root) enable the service script using the following command:</p>
                <div style="background-color:silver;"><code># systemctl enable activemq</code></div></li>
            <li><p>(ssh:clbtmari01:root) run activemq service using the following command:</p>
                <div style="background-color:silver;"><code># systemctl start activemq</code></div></li>
            <li><p>(ssh:clbtmari01:root) check status of the service using the following command:</p>
                <div style="background-color:silver;"><code># systemctl status activemq</code></div></li>
            <li><p>(ssh:clbtmari01:root) output of the command above must be like the following:</p>
                <div style="background-color:silver;"><code>activemq.service - ActiveMQ<br/>
Loaded: loaded (/etc/systemd/system/activemq.service; enabled; vendor preset: disabled)<br/>
Active: <font color="green"><b>active (running)</b></font> since Mon 2019-05-27 07:26:06 EDT; 4min 3s ago<br/>
Process: 2967 ExecStart=/app/activemq/apache-activemq-5.15.9/bin/activemq start (code=exited, status=0/SUCCESS)<br/>
Main PID: 3063 (java)<br/>
CGroup: /system.slice/activemq.service<br/>
└─3063 /app/java/jdk-11.0.2/bin/java -Xms64M -Xmx1G -Djava.util.logging.config.file=logging.properties -Djava.security.auth.login.config=/app/a...<br/>
<br/>
May 27 07:26:05 localhost.localdomain systemd[1]: Starting ActiveMQ...<br/>
May 27 07:26:06 localhost.localdomain activemq[2967]: INFO: Loading '/app/activemq/apache-activemq-5.15.9//bin/env'<br/>
May 27 07:26:06 localhost.localdomain activemq[2967]: INFO: Using java '/app/java/jdk-11.0.2/bin/java'<br/>
May 27 07:26:06 localhost.localdomain activemq[2967]: INFO: Starting - inspect logfiles specified in logging.properties and log4j.properties to get details<br/>
May 27 07:26:06 localhost.localdomain systemd[1]: Started ActiveMQ.</code></div></li>
    </ol>
    <h2>Install Elastic Search &amp; Configure</h2>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) create directory for elastic search using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir elastic-search/</code></div></li>
        <li><p>download elastic search distributive for linux (<b>*.tar.gz</b>) from <a href="https://www.elastic.co/downloads/past-releases/elasticsearch-7-1-0">official website (7.1.0 version)</a></p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>upload elastic search distributive on the box to the <b>/app/elastic-search/</b> directory using any sftp client</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/elastic-search/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/elastic-search/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) unpack elastic search distributive using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -xzf <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete elastic search distributive using the following command:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/elastic-search/<font color="red">&lt;elasticsearch_home&gt;</font>/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/elastic-search/elasticsearch-7.1.0/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>config/elasticsearch.yml</b>: add the following text at the end of the file</p>
            <div style="background-color:silver;"><code>>>> START /app/elastic-search/<font color="red">&lt;elasticsearch_home&gt;</font>/config/elasticsearch.yml<br/>
xpack.security.enabled: true<br/>
xpack.security.authc.accept_default_password: false<br/>
xpack.security.transport.ssl.enabled: true<br/>
<br/>
xpack.security.authc.realms:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;file.realm1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order: 0<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>config/elasticsearch.yml</b>: </p>
            <div style="background-color:silver;"><code>>>> START the following lines<br/>
# Set the bind address to a specific IP (IPv4 or IPv6):<br/>
#<br/>
<font color="red">#</font>network.host: 192.168.0.1<br/>
#<br/>
# Set a custom port for HTTP:<br/>
#<br/>
<font color="red">#</font>http.port: 9200<br/>
#<br/>
>>> FINISH</code></div><br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/elastic-search/<font color="red">&lt;elasticsearch_home&gt;</font>/config/elasticsearch.yml<br/>
# Set the bind address to a specific IP (IPv4 or IPv6):<br/>
#<br/>
network.host: <font color="red">0.0.0.0</font><br/>
#<br/>
# Set a custom port for HTTP:<br/>
#<br/>
http.port: 9200<br/>
#<br/>
>>> FINISH</code></div>
<br/>
and<br/>
<br/>
<div style="background-color:silver;"><code>>>> START the following lines<br/>
# ---------------------------------- Cluster -----------------------------------<br/>
#<br/>
# Use a descriptive name for your cluster:<br/>
#<br/>
<font color="red">#</font>cluster.name: my-application<br/>
#<br/>
# ------------------------------------ Node ------------------------------------<br/>
#<br/>
# Use a descriptive name for the node:<br/>
#<br/>
<font color="red">#</font>node.name: node-1<br/>
>>> FINISH</code></div><br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>> START the following lines<br/>
# ---------------------------------- Cluster -----------------------------------<br/>
#<br/>
# Use a descriptive name for your cluster:<br/>
#<br/>
cluster.name: <font color="red">memfis-stage-cluster</font><br/>
#<br/>
# ------------------------------------ Node ------------------------------------<br/>
#<br/>
# Use a descriptive name for the node:<br/>
#<br/>
node.name: <font color="red">memfis-stage-cluster-node</font><br/>
>>> FINISH</code></div>
<br/>
and<br/>
<br/>
<div style="background-color:silver;"><code>>>> START the following lines<br/>
<font color="red">#</font>cluster.initial_master_nodes: ["node-1", "node-2"]<br/>
>>> FINISH</code></div><br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>> START the following lines<br/>
cluster.initial_master_nodes: ["<font color="red">memfis-stage-cluster-node</font>"]<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>config/roles.yml</b>: add the following text at the end of the file</p>
            <div style="background-color:silver;"><code>>>> START /app/elastic-search/<font color="red">&lt;elasticsearch_home&gt;</font>/config/roles.yml<br/>
clb_users:<br/>
&nbsp;&nbsp;run_as: [ 'clb1' ]<br/>
&nbsp;&nbsp;indices:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- names: [ 'user' ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;privileges: [ 'all' ]<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) create user clb1 using the following command (<a id="elasticsearch_clb1_password">type in password after execution</a>):</p>
            <div style="background-color:silver;"><code>$ bin/elasticsearch-users useradd clb1</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) give user clb1 the role of clb_users using the following command:</p>
            <div style="background-color:silver;"><code>$ bin/elasticsearch-users roles clb1 -a clb_users</code></div></li>
        <li><p>modify <b>/app/elastic-search/elasticsearch-7.1.0/bin/elasticsearch</b></p>
            <div style="background-color:silver;"><code>>>> START the following lines:<br/>
if ! echo $* | grep -E '(^-d |-d$| -d |--daemonize$|--daemonize )' > /dev/null; then<br/>
exec \<br/>
&nbsp;&nbsp;"$JAVA" \<br/>
&nbsp;&nbsp;$ES_JAVA_OPTS \<br/>
&nbsp;&nbsp;-Des.path.home="$ES_HOME" \<br/>
&nbsp;&nbsp;-Des.path.conf="$ES_PATH_CONF" \<br/>
&nbsp;&nbsp;-Des.distribution.flavor="$ES_DISTRIBUTION_FLAVOR" \<br/>
&nbsp;&nbsp;-Des.distribution.type="$ES_DISTRIBUTION_TYPE" \<br/>
&nbsp;&nbsp;-Des.bundled_jdk="$ES_BUNDLED_JDK" \<br/>
&nbsp;&nbsp;-cp "$ES_CLASSPATH" \<br/>
&nbsp;&nbsp;org.elasticsearch.bootstrap.Elasticsearch \<br/>
&nbsp;&nbsp;"$@"<br/>
else<br/>
&nbsp;exec \<br/>
&nbsp;&nbsp;"$JAVA" \<br/>
&nbsp;&nbsp;$ES_JAVA_OPTS \<br/>
&nbsp;&nbsp;-Des.path.home="$ES_HOME" \<br/>
&nbsp;&nbsp;-Des.path.conf="$ES_PATH_CONF" \<br/>
&nbsp;&nbsp;-Des.distribution.flavor="$ES_DISTRIBUTION_FLAVOR" \<br/>
&nbsp;&nbsp;-Des.distribution.type="$ES_DISTRIBUTION_TYPE" \<br/>
&nbsp;&nbsp;-Des.bundled_jdk="$ES_BUNDLED_JDK" \<br/>
&nbsp;&nbsp;-cp "$ES_CLASSPATH" \<br/>
&nbsp;&nbsp;org.elasticsearch.bootstrap.Elasticsearch \<br/>
&nbsp;&nbsp;"$@" \<br/>
&nbsp;&nbsp;&lt;&amp;- &amp;<br/>
&nbsp;retval=$?<br/>
&nbsp;pid=$!<br/>
&nbsp;[ $retval -eq 0 ] || exit $retval<br/>
&nbsp;if [ ! -z "$ES_STARTUP_SLEEP_TIME" ]; then<br/>
&nbsp;&nbsp;sleep $ES_STARTUP_SLEEP_TIME<br/>
&nbsp;fi<br/>
&nbsp;if ! ps -p $pid > /dev/null ; then<br/>
&nbsp;&nbsp;exit 1<br/>
&nbsp;fi<br/>
&nbsp;exit 0<br/>
fi<br/>
>>> FINISH<br/></code></div>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/elastic-search/elasticsearch-7.1.0/bin/elasticsearch:<br/>
if ! echo $* | grep -E '(^-d |-d$| -d |--daemonize$|--daemonize )' > /dev/null; then<br/>
exec \<br/>
&nbsp;&nbsp;"$JAVA" \<br/>
&nbsp;&nbsp;$ES_JAVA_OPTS \<br/>
&nbsp;&nbsp;-Des.path.home="$ES_HOME" \<br/>
&nbsp;&nbsp;-Des.path.conf="$ES_PATH_CONF" \<br/>
&nbsp;&nbsp;-Des.distribution.flavor="$ES_DISTRIBUTION_FLAVOR" \<br/>
&nbsp;&nbsp;-Des.distribution.type="$ES_DISTRIBUTION_TYPE" \<br/>
&nbsp;&nbsp;-Des.bundled_jdk="$ES_BUNDLED_JDK" \<br/>
&nbsp;&nbsp;-cp "$ES_CLASSPATH" \<br/>
&nbsp;&nbsp;org.elasticsearch.bootstrap.Elasticsearch \<br/>
&nbsp;&nbsp;"$@"<br/><font color="red">
&nbsp;&nbsp;pid=$!<br/>
&nbsp;&nbsp;if ! ps -p $pid > /dev/null ; then<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exit 1<br/>
&nbsp;&nbsp;fi<br/>
&nbsp;&nbsp;echo $pid > "${ES_HOME}/data/elasticsearch.pid"</font><br/>
else<br/>
&nbsp;exec \<br/>
&nbsp;&nbsp;"$JAVA" \<br/>
&nbsp;&nbsp;$ES_JAVA_OPTS \<br/>
&nbsp;&nbsp;-Des.path.home="$ES_HOME" \<br/>
&nbsp;&nbsp;-Des.path.conf="$ES_PATH_CONF" \<br/>
&nbsp;&nbsp;-Des.distribution.flavor="$ES_DISTRIBUTION_FLAVOR" \<br/>
&nbsp;&nbsp;-Des.distribution.type="$ES_DISTRIBUTION_TYPE" \<br/>
&nbsp;&nbsp;-Des.bundled_jdk="$ES_BUNDLED_JDK" \<br/>
&nbsp;&nbsp;-cp "$ES_CLASSPATH" \<br/>
&nbsp;&nbsp;org.elasticsearch.bootstrap.Elasticsearch \<br/>
&nbsp;&nbsp;"$@" \<br/>
&nbsp;&nbsp;&lt;&amp;- &amp;<br/>
&nbsp;retval=$?<br/>
&nbsp;pid=$!<br/>
&nbsp;[ $retval -eq 0 ] || exit $retval<br/>
&nbsp;if [ ! -z "$ES_STARTUP_SLEEP_TIME" ]; then<br/>
&nbsp;&nbsp;sleep $ES_STARTUP_SLEEP_TIME<br/>
&nbsp;fi<br/>
&nbsp;if ! ps -p $pid > /dev/null ; then<br/>
&nbsp;&nbsp;exit 1<br/>
&nbsp;fi<br/><font color="red">
&nbsp;echo $pid > "${ES_HOME}/data/elasticsearch.pid"</font><br/>
&nbsp;exit 0<br/>
fi<br/>
>>> FINISH<br/></code></div></li>
            <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
                <div style="background-color:silver;"><code>$ su</code></div></li>
            <li><p>(ssh:clbtmari01:root) modify <b>/etc/security/limits.conf</b>: add the following text at the end of the file</p>
                <div style="background-color:silver;"><code>>>> START /etc/security/limits.conf<br/>
memfis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nofile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65535<br/>
>>> FINISH</code></div></li>
            <li><p>(ssh:clbtmari01:root) create file <b>/etc/systemd/system/elasticsearch.service</b> with the following content:</p>
                <div style="background-color:silver;"><code>>>> START /etc/systemd/system/elasticsearch.service<br/>
[Unit]<br/>
Description=ElasticSearch<br/>
<br/>
[Service]<br/>
Type=forking<br/>
LimitNOFILE=65535<br/>
PIDFile=/app/elastic-search/elasticsearch-7.1.0/data/elasticsearch.pid<br/>
WorkingDirectory=/app/elastic-search/elasticsearch-7.1.0/bin<br/>
<br/>
User=memfis<br/>
Group=memfis<br/>
<br/>
OOMScoreAdjust=-100<br/>
<br/>
#Environment=JAVA_HOME=/app/java/jdk-11.0.2<br/>
<br/>
ExecStart=/app/elastic-search/elasticsearch-7.1.0/bin/elasticsearch -d<br/>
ExecStop=/bin/kill `cat /app/elastic-search/elasticsearch-7.1.0/data/elasticsearch.pid`<br/>
TimeoutSec=300<br/>
<br/>
[Install]<br/>
WantedBy=multi-user.target<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:root) check status of the service script</p>
            <div style="background-color:silver;"><code># systemctl status elasticsearch</code></div></li>
        <li><p>(ssh:clbtmari01:root) output of the command above must be the following:</p>
            <div style="background-color:silver;"><code>elasticsearch.service - ElasticSearch<br/>
Loaded: loaded (/etc/systemd/system/elasticsearch.service; disabled; vendor preset: disabled)<br/>
Active: inactive (dead)</code></div></li>
        <li><p>(ssh:clbtmari01:root) enable the service script using the following command:</p>
            <div style="background-color:silver;"><code># systemctl enable elasticsearch</code></div></li>
        <li><p>(ssh:clbtmari01:root) run elasticsearch service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl start elasticsearch</code></div></li>
        <li><p>(ssh:clbtmari01:root) add firewall rule for elastic search port for tomcat servers using the following commands:</p>
            <div style="background-color:silver;"><code>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32" port protocol="tcp" port="9200" accept'<br/>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32" port protocol="tcp" port="9200" accept'</code></div></li>
        <li><p>(ssh:clbtmari01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
        <li><p>(ssh:clbtmari01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/elastic-search/<font color="red">&lt;elasticsearch_home&gt;</font>/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/elastic-search/elasticsearch-7.1.0/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) set passwords for reserved users using the following command <a id="elasticsearch_elastic_password">(type in passwords for 6 different users after execution)</a>:</p>
            <div style="background-color:silver;"><code>$ bin/elasticsearch-setup-passwords interactive</code></div></li>
    </ol>
    <h2>Install Apache Cassandra &amp; Configure</h2>
    <ol>
        <li><p>login <b>clbtcsnd01</b> box via ssh using <b>root</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:root) create user memfis (type in password after execution)</p>
            <div style="background-color:silver;"><code># adduser memfis</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) set password for the user using the following command:</p>
            <div style="background-color:silver;"><code># passwd memfis</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) modify <b>/etc/ssh/sshd_config</b></p>
            <div style="background-color:silver;"><code>>>>START the following line:<br/>
<font color="red">#</font>PermitRootLogin no<br/>
>>> FINISH<br/></code></div>
<br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>>START <b>/etc/ssh/sshd_config</b><br/>
PermitRootLogin <font color="red">no</font><br/>
>>> FINISH<br/></code></div></li>
        <li><p>(ssh:clbtcsnd01:root) restart sshd service using the following command</p>
            <div style="background-color:silver;"><code># systemctl restart sshd.service</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) create directory /app using the following command:</p>
            <div style="background-color:silver;"><code># mkdir /app</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) change owner of the /app directory to memfis using the following command:</p>
            <div style="background-color:silver;"><code># chown memfis:memfis /app</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to /app, using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) create directory for java installations using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir java</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to /app/java using the following command:</p>
            <div style="background-color:silver;"><code>$ cd java</code></div></li>
        <li><p>download oracle jdk 1.8 from oficial oracle website (tar.gz)</p></li>
        <li><p>using any sftp client upload jdk to /app/java directory</p></li>
        <li><p>(ssh:clbtcsnd01:memfis) unpack jdk 1.8 using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -zxf <font color="red">&lt;JDK1.8&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) delete jdk distribution:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;JDK1.8&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to home using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) modify .bash_profile file to add the following lines <b>BEFORE "export PATH"</b> of the file (modify paths according to your dir names!!!):</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/.bash_profile<br>
<br/>
# don't add this to $PATH<br/>
export JAVA8_HOME=/app/java/<font color="red">&lt;jdk1.8.0_home&gt;</font><br/>
<br/>
>>> FINISH
            </code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) logout from SSH to have system vars on next SSH session using the following command:</p>
            <div style="background-color:silver;"><code>$ exit</code></div></li>
        <li><p>login <b>clbtcsnd01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to /app/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) create directory for apache cassandra using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir cassandra/</code></div></li>
        <li><p>download apache cassandra from <a href="http://www.apache.org/dyn/closer.lua/cassandra/3.11.4/apache-cassandra-3.11.4-bin.tar.gz">offical website</a></p></li>
        <li><p>upload tar.gz distr of cassandra to the box into /app/cassandra/ via sftp using <b>memfis</b> account.</p></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to /app/cassandra/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/cassandra/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) unpack tar.gz distr of apache cassandra using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -xzf <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) delete distrbutive of cassandra using the following command:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to bin directory of cassandra using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/cassandra/<font color="red">&lt;home_folder&gt;</font>/bin/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) modify <b>cassandra</b> file: replace any occurrence of <b>JAVA_HOME</b> by <b>JAVA<font color="red">8</font>_HOME</b>;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) modify <b>nodetool</b> file: replace any occurrence of <b>JAVA_HOME</b> by <b>JAVA<font color="red">8</font>_HOME</b>;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to conf using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ../conf/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) modify the following keys of <b>cassandra.yaml:</b></p>
            <div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;home_folder&gt;</font>/conf/cassandra.yaml:<br/>
cluster_name: '<font color="red">MemfisStageCluster</font>'<br/>
>>> FINISH<br/></code></div>
            <br/>
            <div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;home_folder&gt;</font>/conf/cassandra.yaml:<br/>
listen_address: <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font><br/>
>>> FINISH<br/></code></div>
            <br/>
            <div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;home_folder&gt;</font>/conf/cassandra.yaml:<br/>
rpc_address: <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font><br/>
>>> FINISH<br/></code></div>
            <br/>
            <div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;home_folder&gt;</font>/conf/cassandra.yaml:<br/>
- seeds: "<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>"<br/>
>>> FINISH<br/></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory back to bin</p>
            <div style="background-color:silver;"><code>$ cd ../bin/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) run cassandra using the following command:</p>
            <div style="background-color:silver;"><code>$ ./cassandra -p /app/cassandra/apache-cassandra-3.11.4/data/cassandra.pid</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) type pwd command:</p>
            <div style="background-color:silver;"><code>$ pwd</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) <a id="path_to_cassandra_bin">copy output (it must be path to bin folder of cassandra);</a></p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to home using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) modify "<font color="red">.bash_profile</font>" file, add the following lines <font color="red">BEFORE "export PATH"</font>:</p>
            <div style="background-color:silver;"><code>>>> START .bash_profile<br/>
<br/>
PATH="<font color="red">&lt;copied_path_from_<a href="#path_to_cassandra_bin">previous_step</a>&gt;</font>:$PATH"<br/>
<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) (check before using the following command: "python -V") install python 2.7 using the following command:</p>
            <div style="background-color:silver;"><code># yum install python2</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) cd directory to home using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) create directory for cql scripts:</p>
            <div style="background-color:silver;"><code>$ mkdir cql</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/cql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-model/cassandra/_initial.cql<br/>
/colaba_back/clb-parent/clb-chat-parent/clb-chat-model/cassandra/alter-2.0.0-1.cql</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to cql using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/cql/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) execute cassandra shell scripts using the following command:</p>
            <div style="background-color:silver;"><code>$ cqlsh -f _initial.cql <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font><br/>
$ cqlsh -k clb_chat -f alter-2.0.0-1.cql <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) login to cassandta shell using the following command:</p>
            <div style="background-color:silver;"><code>$ cqlsh <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
        <li><p>(cqlsh:clbtcsnd01) to see all existed keyspaces execute the following command:</p>
            <div style="background-color:silver;"><code>cqlsh> describe keyspaces;</code></div></li>
        <li><p>(cqlsh:clbtcsnd01) output of the command above must contain "<b>clb_chat</b>";</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(cqlsh:clbtcsnd01) set clb_chat as an active keyspace using the following command:</p>
            <div style="background-color:silver;"><code>cqlsh> use clb_chat;</code></div></li>
        <li><p>(cqlsh:clbtcsnd01) check whether all tables are present in the keyspace using the following command:</p>
            <div style="background-color:silver;"><code>cqlsh:clb_chat> describe tables;</code></div></li>
        <li><p>(cqlsh:clbtcsnd01) exit from cassandra shell console using the following command:</p>
            <div style="background-color:silver;"><code>cqlsh:clb_chat> exit;</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) get PID of cassandra process using the following command:</p>
            <div style="background-color:silver;"><code># ps ax | grep cassandra</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) copy PID number from output, example (<font color="red">PID highlighted</font>):</p>
            <div style="background-color:silver;"><code>&nbsp;<font color="red">4641</font> pts/0    Sl     0:49 /app/java/jdk1.8.0_201/bin/java -Xloggc:./../logs/gc.log -ea -XX:+UseThreadPriorities -XX:ThreadPriorityPolicy=42 -XX:+HeapDumpOnOutOfMemoryError -Xss256k -XX:StringTableSize=1000003 -XX:+AlwaysPreTouch -XX:-UseBiasedLocking -XX:+UseTLAB -XX:+ResizeTLAB -XX:+UseNUMA -XX:+PerfDisableSharedMem -Djava.net.preferIPv4Stack=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:SurvivorRatio=8 -XX:MaxTenuringThreshold=1 -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSWaitDuration=10000 -XX:+CMSParallelInitialMarkEnabled -XX:+CMSEdenChunksRecordAlways -XX:+CMSClassUnloadingEnabled -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintHeapAtGC -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -XX:+PrintPromotionFailure -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=10M -Xms1431M -Xmx1431M -Xmn357M -XX:+UseCondCardMark -XX:CompileCommandFile=./../conf/hotspot_compiler -javaagent:./../lib/jamm-0.3.0.jar -Dcassandra.jmx.local.port=7199 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.password.file=/etc/cassandra/jmxremote.password -Djava.library.path=./../lib/sigar-bin -XX:OnOutOfMemoryError=kill -9 %p -Dlogback.configurationFile=logback.xml -Dcassandra.logdir=./../logs -Dcassandra.storagedir=./../data -cp ./../conf:./../build/classes/main:./../build/classes/thrift:./../lib/airline-0.6.jar:./../lib/antlr-runtime-3.5.2.jar:./../lib/apache-cassandra-3.11.4.jar:./../lib/apache-cassandra-thrift-3.11.4.jar:./../lib/asm-5.0.4.jar:./../lib/caffeine-2.2.6.jar:./../lib/cassandra-driver-core-3.0.1-shaded.jar:./../lib/commons-cli-1.1.jar:./../lib/commons-codec-1.9.jar:./../lib/commons-lang3-3.1.jar:./../lib/commons-math3-3.2.jar:./../lib/compress-lzf-0.8.4.jar:./../lib/concurrentlinkedhashmap-lru-1.4.jar:./../lib/concurrent-trees-2.4.0.jar:./../lib/disruptor-3.0.1.jar:./../lib/ecj-4.4.2.jar:./../lib/guava-18.0.jar:./../lib/HdrHistogram-2.1.9.jar:./../lib/high-scale-lib-1.0.6.jar:./../lib/hppc-0.5.4.jar:./../lib/jackson-core-asl-1.9.13.jar:./../lib/jackson-mapper-asl-1.9.13.jar:./../lib/jamm-0.3.0.jar:./../lib/javax.inject.jar:./../lib/jbcrypt-0.3m.jar:./../lib/jcl-over-slf4j-1.7.7.jar:./../lib/jctools-core-1.2.1.jar:./../lib/jflex-1.6.0.jar:./../lib/jna-4.2.2.jar:./../lib/joda-time-2.4.jar:./../lib/json-simple-1.1.jar:./../lib/jstackjunit-0.0.1.jar:./../lib/libthrift-0.9.2.jar:./../lib/log4j-over-slf4j-1.7.7.jar:./../lib/logback-classic-1.1.3.jar:./../lib/logback-core-1.1.3.jar:./../lib/lz4-1.3.0.jar:./../lib/metrics-core-3.1.5.jar:./../lib/metrics-jvm-3.1.5.jar:./../lib/metrics-logback-3.1.5.jar:./../lib/netty-all-4.0.44.Final.jar:./../lib/ohc-core-0.4.4.jar:./../lib/ohc-core-j8-0.4.4.jar:./../lib/reporter-config3-3.0.3.jar:./../lib/reporter-config-base-3.0.3.jar:./../lib/sigar-1.6.4.jar:./../lib/slf4j-api-1.7.7.jar:./../lib/snakeyaml-1.11.jar:./../lib/snappy-java-1.1.1.7.jar:./../lib/snowball-stemmer-1.3.0.581.1.jar:./../lib/ST4-4.0.8.jar:./../lib/stream-2.5.2.jar:./../lib/thrift-server-0.3.7.jar:./../lib/jsr223/*/*.jar org.apache.cassandra.service.CassandraDaemon<br/>
 4763 pts/0    S+     0:00 grep --color=auto cassandra </code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) stop cassandra using the following command</p>
            <div style="background-color:silver;"><code>kill <font color="red">&lt;PID&gt;</font></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) create file <b>/etc/systemd/system/cassandra.service</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /etc/systemd/system/cassandra.service<br/>
[Unit]<br/>
Description=Cassandra<br/>
<br/>
[Service]<br/>
Type=forking<br/>
LimitNOFILE=65535<br/>
PIDFile=/app/cassandra/apache-cassandra-3.11.4/cassandra.pid<br/>
WorkingDirectory=/app/cassandra/apache-cassandra-3.11.4/bin<br/>
<br/>
User=memfis<br/>
Group=memfis<br/>
<br/>
OOMScoreAdjust=-100<br/>
<br/>
Environment=JAVA8_HOME=/app/java/jdk1.8.0_201<br/>
<br/>
ExecStart=/app/cassandra/apache-cassandra-3.11.4/bin/cassandra -p /app/cassandra/apache-cassandra-3.11.4/cassandra.pid<br/>
ExecStop=/bin/kill `cat /app/cassandra/apache-cassandra-3.11.4/cassandra.pid`<br/>
TimeoutSec=300<br/>
<br/>
[Install]<br/>
WantedBy=multi-user.target<br/>
>>> FINISH<br/></code></div></li>
        <li><p>(ssh:clbtcsnd01:root) check status of the service script</p>
            <div style="background-color:silver;"><code># systemctl status cassandra</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) output of the command above must be the following:</p>
            <div style="background-color:silver;"><code>cassandra.service - Cassandra<br/>
   Loaded: loaded (/etc/systemd/system/cassandra.service; disabled; vendor preset: disabled)<br/>
   Active: inactive (dead)</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) enable the service script using the following command:</p>
            <div style="background-color:silver;"><code># systemctl enable cassandra</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) run cassandra service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl start cassandra</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to <b>/app/cassandra/<font color="red">&lt;cassandra_home&gt;</font>/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/cassandra/apache-cassandra-3.11.4/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) modify conf/cassandra.yaml: change authenticator to PasswordAuthenticator</p>
            <div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;cassandra_home&gt;</font>/conf/cassandra.yaml<br/>
authenticator: AllowAllAuthenticator<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;cassandra_home&gt;</font>/conf/cassandra.yaml<br/>
authenticator: PasswordAuthenticator<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) modify conf/cassandra.yaml: change authorizer to CassandraAuthorizer</p>
            <div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;cassandra_home&gt;</font>/conf/cassandra.yaml<br/>
authorizer: AllowAllAuthorizer<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/cassandra/<font color="red">&lt;cassandra_home&gt;</font>/conf/cassandra.yaml<br/>
authorizer: CassandraAuthorizer<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code># su</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) restart Apache Cassandra</p>
            <div style="background-color:silver;"><code># service cassandra.service restart</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) login to cassandra shell with the default superuser using the following command:</p>
            <div style="background-color:silver;"><code># cqlsh -u cassandra -p cassandra <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
        <li><p>(cqlsh:clbtcsnd01:cassandra) <a id="cassandra_clb_superuser_password">create user clb_superuser using the following command</a>:</p>
            <div style="background-color:silver;"><code>cqlsh> CREATE ROLE clb_superuser WITH PASSWORD = '<font color="red">&lt;your_password></font>' AND SUPERUSER = true AND LOGIN = true;</code></div></li>
        <li><p>(cqlsh:clbtcsnd01:cassandra) <a id="cassandra_clb1_password">create user clb1 using the following command</a>:</p>
            <div style="background-color:silver;"><code>cqlsh> CREATE ROLE clb1 WITH PASSWORD = '<font color="red">&lt;your_password></font>' AND SUPERUSER = false AND LOGIN = true;<br/>
cqlsh> GRANT ALL PERMISSIONS on KEYSPACE clb_chat to clb1;</code></div></li>
        <li><p>(cqlsh:clbtcsnd01:cassandra) exit from cassandra shell console using the following command:</p>
            <div style="background-color:silver;"><code>cqlsh> exit;</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) login to cassandra shell with user clb_superuser using the following command (<a href="#cassandra_clb_superuser_password">requires password</a>):</p>
            <div style="background-color:silver;"><code>$ cqlsh -u clb_superuser <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
        <li><p>(cqlsh:clbtcsnd01:clb_superuser) to prevent security breaches, neutralize the <i>cassandra</i> account (cannot be deleted) using the following command:</p>
            <div style="background-color:silver;"><code>cqlsh> ALTER ROLE cassandra WITH PASSWORD='<font color="red">&lt;another_password></font>' AND SUPERUSER=false;</code></div></li>
        <li><p>(cqlsh:clbtcsnd01:clb_superuser) create user clb exit from cassandra shell console using the following command:</p>
            <div style="background-color:silver;"><code>cqlsh> exit;</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code># su</code></div></li>
        <li><p>(ssh:clbtcsnd01:root) restart Apache Cassandra</p>
            <div style="background-color:silver;"><code># service cassandra.service restart</code></div></li>
        <li><p>(ssh:clbtmari01:root) add firewall rule for cassandra port for tomcat servers using the following commands:</p>
            <div style="background-color:silver;"><code>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32" port protocol="tcp" port="9042" accept'<br/>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32" port protocol="tcp" port="9042" accept'</code></div></li>
        <li><p>(ssh:clbtmari01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>

    <h2>Install Apache Tomcat, Configure &amp; Deploy Memfis apps on clbttmct01</h2>
    <ol>
        <li><p>fetch collaba_back repo;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>root</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct01:root) create user memfis (type in password after execution)</p>
            <div style="background-color:silver;"><code># adduser memfis</code></div></li>
        <li><p>(ssh:clbttmct01:root) set password for the user using the following command:</p>
            <div style="background-color:silver;"><code># passwd memfis</code></div></li>
        <li><p>(ssh:clbttmct01:root) modify <b>/etc/ssh/sshd_config</b></p>
            <div style="background-color:silver;"><code>>>>START the following line:<br/>
<font color="red">#</font>PermitRootLogin no<br/>
>>> FINISH<br/></code></div>
<br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>>START <b>/etc/ssh/sshd_config</b><br/>
PermitRootLogin <font color="red">no</font><br/>
>>> FINISH<br/></code></div></li>
        <li><p>(ssh:clbttmct01:root) restart sshd service using the following command</p>
            <div style="background-color:silver;"><code># systemctl restart sshd.service</code></div></li>
        <li><p>(ssh:clbttmct01:root) create directory /app using the following command:</p>
            <div style="background-color:silver;"><code># mkdir /app</code></div></li>
        <li><p>(ssh:clbttmct01:root) change owner of the /app directory to memfis using the following command:</p>
            <div style="background-color:silver;"><code># chown memfis:memfis /app</code></div></li>
        <li><p>(ssh:clbttmct01:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create directory for java installations using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir java</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to /app/java using the following command:</p>
            <div style="background-color:silver;"><code>$ cd java</code></div></li>
        <li><p>download openjdk 11 from official openjdk website (tar.gz)</p></li>
        <li><p>using any sftp client upload jdk to /app/java directory</p></li>
        <li><p>(ssh:clbttmct01:memfis) unpack jdk 11 using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -zxf <font color="red">&lt;JDK11&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete jdk distribution:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;JDK11&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to home using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify .bash_profile file to add the following lines <b>BEFORE "export PATH"</b> of the file (modify paths according to your dir names!!!):</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/.bash_profile<br>
<br/>
export JAVA_HOME=/app/java/<font color="red">&lt;jdk_11_home&gt;</font><br/>
PATH="$JAVA_HOME/bin:$PATH"<br/>
<br/>
>>> FINISH
            </code></div></li>
        <li><p>(ssh:clbttmct01:memfis) logout from SSH to have system vars on next SSH session using the following command:</p>
            <div style="background-color:silver;"><code>$ exit</code></div></li>
        <li><p>login on <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create directory for apache tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir tomcat/</code></div></li>
        <li><p>download tomcat 9.x (download type: core; distr format: tar.gz) from <a href="https://tomcat.apache.org/download-90.cgi">oficial website</a> (9.0.21 version);</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>upload tomcat distributive to <b>/app/tomcat/</b> directory of the box using any sftp client;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) unpack tomcat distr using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -xzf <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete tomcat distr using the following command:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files/directories in the directory using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf docs/<br/>
$ rm -rf examples/<br/>
$ rm -rf host-manager/<br/>
$ rm -rf manager/<br/>
$ rm -rf ROOT/</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to conf directory of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ../conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create file <b>common.properties</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/common.properties<br/>
email.host=<font color="red">&lt;smpt_host&gt;</font><br/>
email.port=587<br/>
email.host.user=<font color="red">&lt;email_account&gt;</font><br/>
email.host.password=<font color="red">&lt;email_password&gt;</font><br/>
email.from=<font color="red">&lt;email_from&gt;</font><br/>
<br/>
front.url=https://<font color="red">&lt;domain_name&gt;</font><br/>
front.url.activate=/join/activate/<br/>
front.url.reset.password=/reset-password/<br/>
<br/>
chat.token.notbefore.tolerance.seconds=60<br/>
chat.token.lifetime.seconds=300<br/>
<br/>
crypto.secret.key=<font color="red">&lt;your_secret_key></font><br/>
<br/>
file.upload.max.size=10485760<br/>
<br/>
dropbox.client.id=<font color="red">&lt;dropbox_id&gt;</font><br/>
dropbox.client.secret=<font color="red">&lt;dropbox_secret&gt;</font><br/>
dropbox.redirecturi.organization=https://<font color="red">&lt;domain_name&gt;</font>/organizations-services/dropbox/<br/>
dropbox.redirecturi.project=https://<font color="red">&lt;domain_name&gt;</font>/projects-services/dropbox/<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create <b>log4j2.xml</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/log4j2.xml<br/>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>
&lt;Configuration status="WARN"&gt;<br/>
&nbsp;&nbsp;&lt;Appenders&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Console name="Console" target="SYSTEM_OUT"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout pattern="%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Console&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File" append="true" fileName="${sys:catalina.home}/logs/memfis.log" filePattern="${sys:catalina.home}/logs/memfis.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&lt;/Appenders&gt;<br/>
&nbsp;&nbsp;&lt;Loggers&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Root level="debug"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File"/&gt;<br/>
&nbsp;&nbsp;&lt;/Root&gt;<br/>
&nbsp;&nbsp;&lt;/Loggers&gt;<br/>
&lt;/Configuration&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create <b>cassandra.conf</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/cassandra.conf<br/>
datastax-java-driver {<br/>
&nbsp;&nbsp;advanced.auth-provider {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;class = PlainTextAuthProvider<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username = clb1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password = <font color="red">&lt;cassandra:clb1_password></font><br/>
&nbsp;&nbsp;}<br/>
}<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text as LAST child elements of <b>/Server/GlobalNamingResource</b> element</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- MariaDB --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb mariadb connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>:3306/clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password&gt;</font>" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- Cassandra --&gt;<br/>
&nbsp;&nbsp;&lt;!-- examples: <br/>
&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/application.conf" <br/>
&nbsp;&nbsp;localDataCenter="dc_ru1" <br/>
&nbsp;&nbsp;nodes="192.168.0.175:9042;192.168.0.176:9042"<br/>
&nbsp;&nbsp;localDataCenter="datacenter1" <br/>
&nbsp;&nbsp;nodes="localhost:9042" <br/>
&nbsp;&nbsp;--&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /><br/><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Factory --><br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;brokerName="LocalActiveMQBroker"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;brokerURL="tcp://<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>:61616"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="JMS Connection Factory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/ConnectionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.ActiveMQConnectionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;useEmbeddedBroker="false"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;userName="clb1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;activemq:clb1_password></font>" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Task Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/task.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="task.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Issue Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/issue.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="issue.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Project Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/project.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="project.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- Elastic Search --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.elasticsearch.ElasticsearchClientFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="elasticsearch/client"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>:9200"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;scheme="http"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.elasticsearch.client.RestHighLevelClient"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="clb1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;elasticsearch:clb1_password></font>" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: change port http port to <b>8000</b> and bind address to <b>0.0.0.0</b></p>
            <div style="background-color:silver;"><code>>>> START the following<br/>
&nbsp;&nbsp;&lt;Connector port="8080" protocol="HTTP/1.1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;connectionTimeout="20000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;redirectPort="8443" /&gt;<br/>
>>> FINISH<br/></code></div>
<br/>
to<br/>
<br/><div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Connector port="<font color="red">8000</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">address="0.0.0.0"</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;protocol="HTTP/1.1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;connectionTimeout="20000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;redirectPort="8443" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: change bind address to 127.0.0.1</p>
            <div style="background-color:silver;"><code>>>> START the following<br/>
&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443"/&gt;<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/server.xml<br/>
&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" <font color="red">address="127.0.0.1"</font>/&gt;<br/>
>>> FINISH</code></div>
</li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add the following text as <font color="red"><b>LAST</b></font> children elements of <b>/Context</b> element</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jdbc/postgresqldb" global="jdbc/postgresqldb" type="javax.sql.DataSource"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jdbc/mariadb" global="jdbc/mariadb" type="javax.sql.DataSource"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="nosql/cassandra/cqlsession" global="nosql/cassandra/cqlsession" type="com.datastax.oss.driver.api.core.CqlSession"/&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/ConnectionFactory" global="jms/ConnectionFactory" type="org.apache.activemq.ActiveMQConnectionFactory"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/task.chat" global="jms/topic/task.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/issue.chat" global="jms/topic/issue.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/project.chat" global="jms/topic/project.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;ResourceLink name="elasticsearch/client" global="elasticsearch/client" type="org.elasticsearch.client.RestHighLevelClient"/&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to bin dir of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ../bin/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create file setenv.sh with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/bin/setenv.sh<br/>
JAVA_OPTS="$JAVA_OPTS -Dlog4j.configurationFile=$CATALINA_HOME/conf/log4j2.xml"<br/>
<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) make setenv.sh executable using the following command:</p>
            <div style="background-color:silver;"><code>$ chmod +x setenv.sh</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) create file <b>/etc/systemd/system/tomcat.service</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /etc/systemd/system/tomcat.service<br/>
[Unit]<br/>
Description=Tomcat<br/>
<br/>
[Service]<br/>
Type=forking<br/>
LimitNOFILE=65535<br/>
PIDFile=/app/tomcat/apache-tomcat-9.0.21/catalina.pid<br/>
WorkingDirectory=/app/tomcat/apache-tomcat-9.0.21/bin<br/>
<br/>
User=memfis<br/>
Group=memfis<br/>
<br/>
OOMScoreAdjust=-100<br/>
<br/>
Environment=JAVA_HOME=/app/java/jdk-11.0.2<br/>
Environment=CATALINA_PID=/app/tomcat/apache-tomcat-9.0.21/catalina.pid<br/>
<br/>
ExecStart=/app/tomcat/apache-tomcat-9.0.21/bin/startup.sh<br/>
ExecStop=/app/tomcat/apache-tomcat-9.0.21/bin/shutdown.sh<br/>
TimeoutSec=300<br/>
<br/>
[Install]<br/>
WantedBy=multi-user.target<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:root) check status of the service script</p>
            <div style="background-color:silver;"><code># systemctl status tomcat</code></div></li>
        <li><p>(ssh:clbttmct01:root)  output of the command above must be the following:</p>
            <div style="background-color:silver;"><code>tomcat.service - Tomcat<br/>
        Loaded: loaded (/etc/systemd/system/tomcat.service; disabled; vendor preset: disabled)<br/>
        Active: inactive (dead)</code></div></li>
        <li><p>(ssh:clbttmct01:root) enable the service script using the following command:</p>
            <div style="background-color:silver;"><code># systemctl enable tomcat</code></div></li>
        <li><p>(ssh:clbttmct01:root) run tomcat service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl start tomcat</code></div></li>
        <li><p>(ssh:clbttmct01:root) add firewall rule for tomcat openwire port for mariadb servers using the following command:</p>
            <div style="background-color:silver;"><code>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>
    <h2>Install Apache Tomcat, Configure &amp; Deploy Memfis apps on clbttmct02</h2>
    <ol>
        <li><p>fetch collaba_back repo;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>root</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct02:root) create user memfis (type in password after execution)</p>
            <div style="background-color:silver;"><code># adduser memfis</code></div></li>
        <li><p>(ssh:clbttmct02:root) set password for the user using the following command:</p>
            <div style="background-color:silver;"><code># passwd memfis</code></div></li>
        <li><p>(ssh:clbttmct02:root) modify <b>/etc/ssh/sshd_config</b></p>
            <div style="background-color:silver;"><code>>>>START the following line:<br/>
<font color="red">#</font>PermitRootLogin no<br/>
>>> FINISH<br/></code></div>
<br/>
to:<br/>
<br/>
<div style="background-color:silver;"><code>>>>START <b>/etc/ssh/sshd_config</b><br/>
PermitRootLogin <font color="red">no</font><br/>
>>> FINISH<br/></code></div></li>
        <li><p>(ssh:clbttmct02:root) restart sshd service using the following command</p>
            <div style="background-color:silver;"><code># systemctl restart sshd.service</code></div></li>
        <li><p>(ssh:clbttmct02:root) create directory /app using the following command:</p>
            <div style="background-color:silver;"><code># mkdir /app</code></div></li>
        <li><p>(ssh:clbttmct02:root) change owner of the /app directory to memfis using the following command:</p>
            <div style="background-color:silver;"><code># chown memfis:memfis /app</code></div></li>
        <li><p>(ssh:clbttmct02:root) switch to the memfis account</p>
            <div style="background-color:silver;"><code># su - memfis</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) create directory for java installations using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir java</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to /app/java using the following command:</p>
            <div style="background-color:silver;"><code>$ cd java</code></div></li>
        <li><p>download openjdk 11 from official openjdk website (tar.gz)</p></li>
        <li><p>using any sftp client upload jdk to /app/java directory</p></li>
        <li><p>(ssh:clbttmct02:memfis) unpack jdk 11 using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -zxf <font color="red">&lt;JDK11&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete jdk distribution:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;JDK11&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to home using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify .bash_profile file to add the following lines <b>BEFORE "export PATH"</b> of the file (modify paths according to your dir names!!!):</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/.bash_profile<br>
<br/>
export JAVA_HOME=/app/java/<font color="red">&lt;jdk_11_home&gt;</font><br/>
PATH="$JAVA_HOME/bin:$PATH"<br/>
<br/>
>>> FINISH
            </code></div></li>
        <li><p>(ssh:clbttmct02:memfis) logout from SSH to have system vars on next SSH session using the following command:</p>
            <div style="background-color:silver;"><code>$ exit</code></div></li>
        <li><p>login on <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) create directory for apache tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir tomcat/</code></div></li>
        <li><p>download tomcat 9.x (download type: core; distr format: tar.gz) from <a href="https://tomcat.apache.org/download-90.cgi">oficial website</a> (9.0.21 version);</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>upload tomcat distributive to <b>/app/tomcat/</b> directory of the box using any sftp client;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) unpack tomcat distr using the following command:</p>
            <div style="background-color:silver;"><code>$ tar -xzf <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete tomcat distr using the following command:</p>
            <div style="background-color:silver;"><code>$ rm <font color="red">&lt;filename&gt;</font>.tar.gz</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files/directories in the directory using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf docs/<br/>
$ rm -rf examples/<br/>
$ rm -rf host-manager/<br/>
$ rm -rf manager/<br/>
$ rm -rf ROOT/</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to conf directory of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ../conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) create file <b>common.properties</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/common.properties<br/>
email.host=<font color="red">&lt;smpt_host&gt;</font><br/>
email.port=587<br/>
email.host.user=<font color="red">&lt;email_account&gt;</font><br/>
email.host.password=<font color="red">&lt;email_password&gt;</font><br/>
email.from=<font color="red">&lt;email_from&gt;</font><br/>
<br/>
front.url=https://<font color="red">&lt;domain_name&gt;</font><br/>
front.url.activate=/join/activate/<br/>
front.url.reset.password=/reset-password/<br/>
<br/>
chat.token.notbefore.tolerance.seconds=60<br/>
chat.token.lifetime.seconds=300<br/>
<br/>
crypto.secret.key=a1yhaa6akhacjaavajalaa<br/>
<br/>
file.upload.max.size=10485760<br/>
<br/>
dropbox.client.id=<font color="red">&lt;dropbox_id&gt;</font><br/>
dropbox.client.secret=<font color="red">&lt;dropbox_secret&gt;</font><br/>
dropbox.redirecturi.organization=https://<font color="red">&lt;domain_name&gt;</font>/organizations-services/dropbox/<br/>
dropbox.redirecturi.project=https://<font color="red">&lt;domain_name&gt;</font>/projects-services/dropbox/<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) create <b>log4j2.xml</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/log4j2.xml<br/>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>
&lt;Configuration status="WARN"&gt;<br/>
&nbsp;&nbsp;&lt;Appenders&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Console name="Console" target="SYSTEM_OUT"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout pattern="%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Console&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File" append="true" fileName="${sys:catalina.home}/logs/memfis.log" filePattern="${sys:catalina.home}/logs/memfis.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&lt;/Appenders&gt;<br/>
&nbsp;&nbsp;&lt;Loggers&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Root level="debug"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File"/&gt;<br/>
&nbsp;&nbsp;&lt;/Root&gt;<br/>
&nbsp;&nbsp;&lt;/Loggers&gt;<br/>
&lt;/Configuration&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) create <b>cassandra.conf</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/cassandra.conf<br/>
datastax-java-driver {<br/>
&nbsp;&nbsp;advanced.auth-provider {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;class = PlainTextAuthProvider<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username = clb1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password = <font color="red">&lt;cassandra:clb1_password></font><br/>
&nbsp;&nbsp;}<br/>
}<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text as LAST child elements of <b>/Server/GlobalNamingResource</b> element</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- MariaDB --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb mariadb connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>:3306/clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password&gt;</font>" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- Cassandra --&gt;<br/>
&nbsp;&nbsp;&lt;!-- examples: <br/>
&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/application.conf" <br/>
&nbsp;&nbsp;localDataCenter="dc_ru1" <br/>
&nbsp;&nbsp;nodes="192.168.0.175:9042;192.168.0.176:9042"<br/>
&nbsp;&nbsp;localDataCenter="datacenter1" <br/>
&nbsp;&nbsp;nodes="localhost:9042" <br/>
&nbsp;&nbsp;--&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /><br/><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Factory --><br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;brokerName="LocalActiveMQBroker"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;brokerURL="tcp://<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>:61616"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="JMS Connection Factory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/ConnectionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.ActiveMQConnectionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;useEmbeddedBroker="false"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;userName="clb1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;activemq:clb1_password></font>" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Task Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/task.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="task.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Issue Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/issue.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="issue.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Project Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/project.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="project.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;!-- Elastic Search --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.elasticsearch.ElasticsearchClientFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="elasticsearch/client"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>:9200"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;scheme="http"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;singleton="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.elasticsearch.client.RestHighLevelClient"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="clb1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;elasticsearch:clb1_password></font>" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: change port http port to <b>8000</b> and bind address to <b>0.0.0.0</b></p>
            <div style="background-color:silver;"><code>>>> START the following<br/>
&nbsp;&nbsp;&lt;Connector port="8080" protocol="HTTP/1.1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;connectionTimeout="20000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;redirectPort="8443" /&gt;<br/>
>>> FINISH<br/></code></div>
<br/>
to<br/>
<br/><div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Connector port="<font color="red">8000</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">address="0.0.0.0"</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;protocol="HTTP/1.1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;connectionTimeout="20000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;redirectPort="8443" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: change bind address to 127.0.0.1</p>
            <div style="background-color:silver;"><code>>>> START the following<br/>
&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443"/&gt;<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/server.xml<br/>
&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" <font color="red">address="127.0.0.1"</font>/&gt;<br/>
>>> FINISH</code></div>
</li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add the following text as <font color="red"><b>LAST</b></font> children elements of <b>/Context</b> element</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jdbc/postgresqldb" global="jdbc/postgresqldb" type="javax.sql.DataSource"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jdbc/mariadb" global="jdbc/mariadb" type="javax.sql.DataSource"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="nosql/cassandra/cqlsession" global="nosql/cassandra/cqlsession" type="com.datastax.oss.driver.api.core.CqlSession"/&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/ConnectionFactory" global="jms/ConnectionFactory" type="org.apache.activemq.ActiveMQConnectionFactory"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/task.chat" global="jms/topic/task.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/issue.chat" global="jms/topic/issue.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/project.chat" global="jms/topic/project.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;ResourceLink name="elasticsearch/client" global="elasticsearch/client" type="org.elasticsearch.client.RestHighLevelClient"/&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to bin dir of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ../bin/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) create file setenv.sh with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/bin/setenv.sh<br/>
JAVA_OPTS="$JAVA_OPTS -Dlog4j.configurationFile=$CATALINA_HOME/conf/log4j2.xml"<br/>
<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) make setenv.sh executable using the following command:</p>
            <div style="background-color:silver;"><code>$ chmod +x setenv.sh</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) create file <b>/etc/systemd/system/tomcat.service</b> with the following content:</p>
            <div style="background-color:silver;"><code>>>> START /etc/systemd/system/tomcat.service<br/>
[Unit]<br/>
Description=Tomcat<br/>
<br/>
[Service]<br/>
Type=forking<br/>
LimitNOFILE=65535<br/>
PIDFile=/app/tomcat/apache-tomcat-9.0.21/catalina.pid<br/>
WorkingDirectory=/app/tomcat/apache-tomcat-9.0.21/bin<br/>
<br/>
User=memfis<br/>
Group=memfis<br/>
<br/>
OOMScoreAdjust=-100<br/>
<br/>
Environment=JAVA_HOME=/app/java/jdk-11.0.2<br/>
Environment=CATALINA_PID=/app/tomcat/apache-tomcat-9.0.21/catalina.pid<br/>
<br/>
ExecStart=/app/tomcat/apache-tomcat-9.0.21/bin/startup.sh<br/>
ExecStop=/app/tomcat/apache-tomcat-9.0.21/bin/shutdown.sh<br/>
TimeoutSec=300<br/>
<br/>
[Install]<br/>
WantedBy=multi-user.target<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:root) check status of the service script</p>
            <div style="background-color:silver;"><code># systemctl status tomcat</code></div></li>
        <li><p>(ssh:clbttmct02:root)  output of the command above must be the following:</p>
            <div style="background-color:silver;"><code>tomcat.service - Tomcat<br/>
        Loaded: loaded (/etc/systemd/system/tomcat.service; disabled; vendor preset: disabled)<br/>
        Active: inactive (dead)</code></div></li>
        <li><p>(ssh:clbttmct02:root) enable the service script using the following command:</p>
            <div style="background-color:silver;"><code># systemctl enable tomcat</code></div></li>
        <li><p>(ssh:clbttmct02:root) run tomcat service using the following command:</p>
            <div style="background-color:silver;"><code># systemctl start tomcat</code></div></li>
        <li><p>(ssh:clbttmct01:root) add firewall rule for tomcat openwire port for mariadb servers using the following command:</p>
            <div style="background-color:silver;"><code>
            # firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>
    <h2>Memfis upgrade on clbtpsql01. Date 2019-07-19</h2>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) create directory auth, using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir auth</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-model/psql/alter-2.0.0-2.sql<br/>
/colaba_back/clb-parent/clb-model/psql/alter-2.0.0-3.sql<br/>
/colaba_back/clb-parent/clb-model/psql/alter-2.0.0-4.sql<br/></code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/auth/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-model/psql/auth/_initial-1.sql<br/>
/colaba_back/clb-parent/clb-model/psql/auth/_initial-2.sql<br/>
/colaba_back/clb-parent/clb-model/psql/auth/alter-2.0.0-1.sql</code><br/></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_postgres_password">password of postgres</a> user on first step and <a href="#psql_hibernate_password">password for hibernate user</a> on the next commands)</p>
            <div style="background-color:silver;"><code>$ psql -U postgres -d postgres -a -f auth/_initial-1.sql<br/>
$ psql -U hibernate -d clb_auth -a -f auth/_initial-2.sql<br/>
$ psql -U hibernate -d clb_auth -a -f auth/alter-2.0.0-1.sql<br/>
$ psql -U hibernate -d clb -a -f alter-2.0.0-2.sql<br/>
$ psql -U hibernate -d clb -a -f alter-2.0.0-3.sql<br/>
$ psql -U hibernate -d clb -a -f alter-2.0.0-4.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtpsql01:root) add firewall rule for clbtmari01, to allow script for elasticsearch to sync data with postgresql using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>/32" port protocol="tcp" port="5432" accept'</code></div></li>
        <li><p>(ssh:clbtpsql01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
        <li><p>(ssh:clbtpsql01:root) modify <b>/var/lib/pgsql/data/pg_hba.conf</b></p>
            <div style="background-color:silver;"><code>>>> START the following line<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>
>>> START /var/lib/pgsql/data/pg_hba.conf<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5<br/>
host&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>/32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtpsql01:root) restart postgresql using the following command (<i>on custom version of progres the service name will be different, use "systemctl list-units | grep post" to get actual name</i>):</p>
            <div style="background-color:silver;"><code># service postgresql.service restart</code></div></li>
    </ol>
    <h2>Memfis upgrade on clbtmari01. Date 2019-07-19</h2>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/mysql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-model/mysql/alter-2.0.0-2.sql<br/>
/colaba_back/clb-parent/clb-chat-parent/clb-chat-model/mysql/alter-2.0.0-3.sql<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_chat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_chat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute altering scripts using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [clb_chat]> source /home/memfis/mysql/alter-2.0.0-2.sql<br/>
MariaDB [clb_chat]> source /home/memfis/mysql/alter-2.0.0-3.sql<br/></code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [clb_chat]> exit;</code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/elastic-search/elasticsearch-7.1.0/config/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/elastic-search/elasticsearch-7.1.0/config/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify roles.yml: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/elastic-search/elasticsearch-7.1.0/config/roles.yml<br/>
- names: [ 'user' ]<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/elastic-search/elasticsearch-7.1.0/config/roles.yml<br/>
- names: [ 'user'<font color="red">, 'organization', 'project'</font> ]<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) create directory elasticsearch using the following command:</p>
            <div style="background-color:silver;"><code># mkdir elasticsearch</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/elasticsearch/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/elasticsearch/</code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/elasticsearch/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-elasticsearch-datasync/elasticsearch-mapping-scripts/_initial.sh<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/clb-elasticsearch-datasync-2.0.0-RELEASE.jar<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify ~/elasticsearch/_initial.sh: change <font color="red">127.0.0.1</font> to <font color="red">&lt;external_ip_of_clbtmari01&gt;</font> in every command (should be 7 times)</p></li>
        <li><p>(ssh:clbtmari01:memfis) execute elasticsearch curl script using the following command (<a href="#elasticsearch_elastic_password">requires password for elastic user</a> 7 times):</p>
            <div style="background-color:silver;"><code>$ bash ./_initial.sh</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) the output for this command should be either</p>
            <div style="background-color:silver;"><code>$ {"acknowledged":true}</code></div><br/>
or be like<br/>
<br/>
<div style="background-color:silver;"><code>$ {"error":{"root_cause":[{"type":"index_not_found_exception","reason":"no such index [user]","resource.type":"index_or_alias","resource.id":"user","index_uuid":"_na_","index":"user"}],"type":"index_not_found_exception","reason":"no such index [user]","resource.type":"index_or_alias","resource.id":"user","index_uuid":"_na_","index":"user"},"status":404}</code></div><br/>
where <b>user</b> can be substituted with <b>organization</b> or <b>project</b><br/></li>
        <li><p>(ssh:clbtmari01:memfis) create file datasync.properties with the following content (requires <a href="#psql_hibernate_password">postgresql:hibernate</a> and <a href="#elasticsearch_clb1_password">elasticsearch:clb1</a> passwords):</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/elasticsearch/datasync.properties<br/>
database.url=jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb<br/>
database.auth.url=jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_auth<br/>
database.username=hibernate<br/>
database.password=<font color="red">&lt;postgresql:hibernate_password&gt;</font><br/>
<br/>
elasticsearch.nodes=<font color="red">&lt;external_ip_of_clbtmari01&gt;</font>:9200<br/>
elasticsearch.scheme=http<br/>
elasticsearch.username=clb1<br/>
elasticsearch.password=<font color="red">&lt;elasticsearch:clb1_password&gt;</font><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing projects: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-2.0.0-RELEASE.jar datasync.properties</code></div></li>
    </ol>
    <h2>Memfis upgrade on clbtcsnd01. Date 2019-07-19</h2>
    <ol>
        <li><p>login <b>clbtcsnd01</b> box via ssh using <b>root</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/cql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-model/cassandra/alter-2.0.0-2.cql</code><br/></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to cql using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/cql/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) execute cassandra shell scripts using the following command (requires <a href="#cassandra_clb1_password">password</a>):</p>
            <div style="background-color:silver;"><code>$ cqlsh -u clb1 -k clb_chat -f alter-2.0.0-2.cql <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
    </ol>
    <h2>Memfis upgrade on clbttmct01. Date 2019-07-19</h2>
    <ol>
        <li><p>fetch collaba_back repo;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-web.war</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to conf directory of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.task</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.task=/organizations/%s/projects/%s/task/%d<br/>
<br/>
csrf.backdoor.enabled=false<br/>
<br/>
rememberme.token.lifetime.seconds=31622400<br/>
<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">singleton="true"</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_auth postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/auth/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/auth/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_auth"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>ActiveMQ Project Chat Topic</b> (inside<b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Dialogue Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/dialog.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="dialog.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jdbc/postgresqldb</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink global="jdbc/auth/postgresqldb" name="jdbc/auth/postgresqldb" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jms/topic/dialog.chat</b> (inside<b>/Context</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/dialog.chat" global="jms/topic/dialog.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
    </ol>
    <h2>Memfis upgrade on clbttmct02. Date 2019-07-19</h2>
    <ol>
        <li><p>fetch collaba_back repo;</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-web.war</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/<font color="red">&lt;tomcat_home&gt;</font>/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to conf directory of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.task</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.task=/organizations/%s/projects/%s/task/%d<br/>
<br/>
csrf.backdoor.enabled=false<br/>
<br/>
rememberme.token.lifetime.seconds=31622400<br/>
<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">singleton="true"</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div><br/>
<br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_auth postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/auth/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/auth/postgresqldb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_auth"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>ActiveMQ Project Chat Topic</b> (inside<b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Dialogue Chat Topic --&gt;<br/>
&nbsp;&nbsp;&lt;Resource<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/dialog.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="dialog.chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jdbc/postgresqldb</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink global="jdbc/auth/postgresqldb" name="jdbc/auth/postgresqldb" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jms/topic/dialog.chat</b> (inside<b>/Context</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink name="jms/topic/dialog.chat" global="jms/topic/dialog.chat" type="org.apache.activemq.command.ActiveMQTopic"/&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
    </ol>
    <h2>Memfis upgrade on clbttmct01, clbttmct02 and clbtmari01. Date 2019-07-26</h2>
    <p>On the upgrade firewall rule for nginx will be added and vm.max_map_count for elasticsearch will be updated</p>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) add firewall rule for tomcat openwire port for nginx servers using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbtngnx01&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) add firewall rule for tomcat openwire port for nginx servers using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbtngnx01&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct02:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtmari01:root) modify <b>/etc/sysctl.conf</b>: add the following text at the end of the file</p>
                <div style="background-color:silver;"><code>>>> START /etc/sysctl.conf<br/>
vm.max_map_count=262144<br/>
>>> FINISH</code></div></li>
            <li><p>(ssh:clbtmari01:root) load vm.max_map_count changes from file</p>
                <div style="background-color:silver;"><code>systemctl -p</code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-08-06</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-model/psql/alter-2.0.0-5.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-2.0.0-5.sql<br/></code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/mysql/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) create directory stat using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir stat</code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/_initial.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) inside stat/_initial.sql change password of hibernate user:</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/mysql/stat/_initial.sql<br/>
GRANT ALL PRIVILEGES ON clb_stat.* to hibernate@'<font color="red">&lt;external_ip_of_clbttmct01&gt;</font>' IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';<br/>
GRANT ALL PRIVILEGES ON clb_stat.* to hibernate@'<font color="red">&lt;external_ip_of_clbttmct02&gt;</font>' IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';<br/>
GRANT ALL PRIVILEGES ON clb_stat.* to hibernate@'localhost' IDENTIFIED BY '<font color="red">&lt;password&gt;</font>';<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>stat/_initial.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/_initial.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-web.war</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url=https://<font color="red">qast</font>.memfis.org<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url=https://<font color="red">stage</font>.memfis.org<br/>
>>> FINISH</code></div><br/>
and<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
dropbox.redirecturi.organization=https://<font color="red">qast</font>.memfis.org/organizations-services/dropbox/<br/>
dropbox.redirecturi.project=https://<font color="red">qast</font>.memfis.org/projects-services/dropbox/<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
dropbox.redirecturi.organization=https://<font color="red">stage</font>.memfis.org/organizations-services/dropbox/<br/>
dropbox.redirecturi.project=https://<font color="red">stage</font>.memfis.org/projects-services/dropbox/<br/>
>>> FINISH</code></div><br/></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="<font color="red">clb</font> mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;<font color="red">singleton="true"</font><br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_chat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="<font color="red">clb_chat</font> mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_chat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
<font color="yellow">&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" </font>/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>ActiveMQ Dialogue Chat Topic</b> (inside<b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Stat Queue --&gt;<br/>
&nbsp;&nbsp;&lt;Resource auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.stat.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.stat.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jdbc/mariadb</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&lt;ResourceLink name="jdbc/stat/mariadb" global="jdbc/stat/mariadb" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jms/topic/dialog.chat</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
<br/>
&lt;ResourceLink name="jms/queue/clb.stat.q" global="jms/queue/clb.stat.q" type="org.apache.activemq.command.ActiveMQQueue"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-web.war</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url=https://<font color="red">qast</font>.memfis.org<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url=https://<font color="red">stage</font>.memfis.org<br/>
>>> FINISH</code></div><br/>
and<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
dropbox.redirecturi.organization=https://<font color="red">qast</font>.memfis.org/organizations-services/dropbox/<br/>
dropbox.redirecturi.project=https://<font color="red">qast</font>.memfis.org/projects-services/dropbox/<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
dropbox.redirecturi.organization=https://<font color="red">stage</font>.memfis.org/organizations-services/dropbox/<br/>
dropbox.redirecturi.project=https://<font color="red">stage</font>.memfis.org/projects-services/dropbox/<br/>
>>> FINISH</code></div><br/></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="<font color="red">clb</font> mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;<font color="red">singleton="true"</font><br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_chat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="<font color="red">clb_chat</font> mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_chat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
<font color="yellow">&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" </font>/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>ActiveMQ Dialogue Chat Topic</b> (inside<b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Stat Queue --&gt;<br/>
&nbsp;&nbsp;&lt;Resource auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.stat.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.stat.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jdbc/mariadb</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&lt;ResourceLink name="jdbc/stat/mariadb" global="jdbc/stat/mariadb" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jms/topic/dialog.chat</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
<br/>
&lt;ResourceLink name="jms/queue/clb.stat.q" global="jms/queue/clb.stat.q" type="org.apache.activemq.command.ActiveMQQueue"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-08-08</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-model/psql/alter-2.0.0-6.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-2.0.0-6.sql<br/></code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.task</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.accept.invite=/join?invite_key=<br/>
front.url.decline.invite=/decline-email-invite?invite_key=<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.task</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.accept.invite=/join?invite_key=<br/>
front.url.decline.invite=/decline-email-invite?invite_key=<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-08-15</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-model/psql/alter-3.0.0-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.0.0-1.sql<br/></code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.0.0-1.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>stat/alter-3.0.0-1.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.0.0-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/elasticsearch/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/elasticsearch/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf lib/<br/>
$ rm clb-elasticsearch-datasync-2.0.0-RELEASE.jar<br/></code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/elasticsearch/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-elasticsearch-datasync/elasticsearch-mapping-scripts/alter-3.0.0-1.sh<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/clb-elasticsearch-datasync-3.0.0-RELEASE.jar<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify ~/elasticsearch/alter-3.0.0-1.sh: change <font color="red">127.0.0.1</font> to <font color="red">&lt;external_ip_of_clbtmari01&gt;</font></p></li>
        <li><p>(ssh:clbtmari01:memfis) execute elasticsearch curl script using the following command (<a href="#elasticsearch_elastic_password">requires password for elastic user</a>):</p>
            <div style="background-color:silver;"><code>$ bash ./alter-3.0.0-1.sh</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) the output for this command should be</p>
            <div style="background-color:silver;"><code>$ {"acknowledged":true}</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing projects: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.0.0-RELEASE.jar datasync.properties</code></div></li>

    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>email.from</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
email.feedback=testfb@qirk.org<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.accept.invite=/<font color="red">join</font>?invite_key=<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.accept.invite=/<font color="red">accept-email-invite</font>?invite_key=<br/>
>>> FINISH</code></div><br/></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-2.0.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-2.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
       <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.0.0-RELEASE-jar-with-dependencies.jar<br/>
/colaba_back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.0.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>email.from</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
email.feedback=testfb@qirk.org<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.accept.invite=/<font color="red">join</font>?invite_key=<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.accept.invite=/<font color="red">accept-email-invite</font>?invite_key=<br/>
>>> FINISH</code></div><br/></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-08-16</h2>
    <h3>PostgreSQL</h3>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.0.0-2.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change charset of clb_stat to 'utf8mb4' using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> ALTER DATABASE clb_stat CHARACTER SET = 'utf8mb4';</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>stat/alter-3.0.0-1.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.0.0-2.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-08-22</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.0.1-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.0.1-1.sql<br/></code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.0.1-1.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>stat/alter-3.0.1-1.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.0.1-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.0.1-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.0.2-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/colaba_back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.0.1-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.0.2-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-09-01</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.0.2-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.0.2-1.sql<br/></code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.0.2-1.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>stat/alter-3.0.2-1.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.0.2-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Apache Cassandra</h3>
    <ol>
        <li><p>login <b>clbtcsnd01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to cql using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/cql/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) create directory notif using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir notif</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/cql/notif/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-notification-parent/clb-notification-model/cassandra/_initial.cql</code><br/></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) execute cassandra shell scripts using the following command (requires <a href="#cassandra_clb_superuser_password">password</a>):</p>
            <div style="background-color:silver;"><code>$ cqlsh -u clb_superuser -f notif/_initial.cql <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.0.1-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.0.2-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: modify following lines:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">singleton="true"</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /&gt;<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_notif"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/notif/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>ActiveMQ Dialogue Chat Topic</b> (inside<b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Notif Queue --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.notif.source.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.notif.source.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Notif Lookup Subscribers Queue --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.notif.task.lookupsuscribers.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.notif.task.lookupsuscribers.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Notif Topic --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/clb.notif.destination"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.notif.destination"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>nosql/cassandra/cqlsession</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink name="nosql/notif/cassandra/cqlsession" global="nosql/notif/cassandra/cqlsession" type="com.datastax.oss.driver.api.core.CqlSession" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jms/topic/dialog.chat</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink global="jms/queue/clb.notif.source.q" name="jms/queue/clb.notif.source.q" type="org.apache.activemq.command.ActiveMQQueue" /><br/>
&nbsp;&nbsp;&lt;ResourceLink global="jms/queue/clb.notif.task.lookupsuscribers.q" name="jms/queue/clb.notif.task.lookupsuscribers.q" type="org.apache.activemq.command.ActiveMQQueue" /><br/>
&nbsp;&nbsp;&lt;ResourceLink global="jms/topic/clb.notif.destination" name="jms/topic/clb.notif.destination" type="org.apache.activemq.command.ActiveMQTopic" /><br/>
>>> FINISH</code></div></li>
         <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>chat.token.lifetime.seconds</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
notif.token.notbefore.tolerance.seconds=60<br/>
notif.token.lifetime.seconds=300<br/>
notif.list.limit=42<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.0.1-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.0.1-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.0.2-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: modify following lines:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">singleton="true"</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /&gt;<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_chat"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_notif"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/notif/cassandra/cqlsession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.conf" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>ActiveMQ Dialogue Chat Topic</b> (inside<b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Notif Queue --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.notif.source.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.notif.source.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Notif Lookup Subscribers Queue --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.notif.task.lookupsuscribers.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.notif.task.lookupsuscribers.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Notif Topic --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/clb.notif.destination"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.notif.destination"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>nosql/cassandra/cqlsession</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink name="nosql/notif/cassandra/cqlsession" global="nosql/notif/cassandra/cqlsession" type="com.datastax.oss.driver.api.core.CqlSession" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add following rows <font color="red">right after</font> <b>jms/topic/dialog.chat</b> ResourceLink:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&nbsp;&nbsp;&lt;ResourceLink global="jms/queue/clb.notif.source.q" name="jms/queue/clb.notif.source.q" type="org.apache.activemq.command.ActiveMQQueue" /><br/>
&nbsp;&nbsp;&lt;ResourceLink global="jms/queue/clb.notif.task.lookupsuscribers.q" name="jms/queue/clb.notif.task.lookupsuscribers.q" type="org.apache.activemq.command.ActiveMQQueue" /><br/>
&nbsp;&nbsp;&lt;ResourceLink global="jms/topic/clb.notif.destination" name="jms/topic/clb.notif.destination" type="org.apache.activemq.command.ActiveMQTopic" /><br/>
>>> FINISH</code></div></li>
         <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>chat.token.lifetime.seconds</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
notif.token.notbefore.tolerance.seconds=60<br/>
notif.token.lifetime.seconds=300<br/>
notif.list.limit=42<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-09-04</h2>
    <h3>Apache Cassandra</h3>
    <ol>
        <li><p>login <b>clbtcsnd01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) login to cassandra shell with clb_superuser using the following command:</p>
            <div style="background-color:silver;"><code>$ cqlsh -u clb_superuser <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
        <li><p>(cqlsh:clbtcsnd01:clb_superuser) grant permissions to user clb1 on keyspace clb_notif using the following command (requires <a href="#cassandra_clb_superuser_password">password</a>):</p>
            <div style="background-color:silver;"><code>cqlsh> GRANT ALL PERMISSIONS on KEYSPACE clb_notif to clb1;</code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-09-06</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.1.0-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.1.0-1.sql<br/></code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtmari01:root) modify <b>/etc/my.cnf file</b>, <font color="red">after "bind" key </font> insert the following line:</p>
            <div style="background-color:silver;"><code>>>> START /etc/my.cnf<br/>
max_connections=1000<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:root) modify restart mariadb service using the following command:</p>
            <div style="background-color:silver;"><code># service mariadb.service restart</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.0.2-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.1.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">10</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">10</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.activate</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.activate.email=/register?code=<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.0.2-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.0.2-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.1.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">10</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">10</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="<font color="red">50</font>"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.activate</b> variable:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.activate.email=/register?code=<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/elasticsearch/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/elasticsearch/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf lib/<br/>
$ rm clb-elasticsearch-datasync-3.0.0-RELEASE.jar<br/></code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/elasticsearch/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-elasticsearch-datasync/elasticsearch-mapping-scripts/alter-3.1.0-1.sh<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/clb-elasticsearch-datasync-3.1.0-RELEASE.jar<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify ~/elasticsearch/alter-3.1.0-1.sh: change <font color="red">127.0.0.1</font> to <font color="red">&lt;external_ip_of_clbtmari01&gt;</font></p></li>
        <li><p>(ssh:clbtmari01:memfis) execute elasticsearch curl script using the following command (<a href="#elasticsearch_elastic_password">requires password for elastic user</a>):</p>
            <div style="background-color:silver;"><code>$ bash ./alter-3.1.0-1.sh</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) the output for this command should be</p>
            <div style="background-color:silver;"><code>$ {"acknowledged":true}</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing projects: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.1.0-RELEASE.jar datasync.properties user</code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-09-12</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.2.0-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.2.0-1.sql<br/></code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.1.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.2.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.1.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.1.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.2.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-09-20</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.2.0-2.sql<br/>
/back/clb-parent/clb-model/psql/alter-3.3.0-1.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.2.0-2.sql<br/>
$ psql -U hibernate -d clb -a -f alter-3.3.0-1.sql</code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.3.0-1.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>stat/alter-3.3.0-1.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.3.0-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.2.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.3.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.2.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.2.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.3.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis fix. Date 2019-09-23</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.3.0-2.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.3.0-2.sql</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to conf directory of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.task=/organization<font color="red">s</font>/%s/project<font color="red">s</font>/%s/task/%d<br/>
>>> FINISH</code></div>
to
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.task=/organization/%s/project/%s/task/%d<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service restart</code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to conf directory of tomcat using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.task=/organization<font color="red">s</font>/%s/project<font color="red">s</font>/%s/task/%d<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
front.url.task=/organization/%s/project/%s/task/%d<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service restart</code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-09-26</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.3.0-2.sql<br/>
/back/clb-parent/clb-model/psql/alter-3.4.0-1.sql<br/>
/back/clb-parent/clb-model/psql/alter-3.4.0-2.sql<br/>
/back/clb-parent/clb-model/psql/alter-3.4.0-3.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.3.0-2.sql<br/>
$ psql -U hibernate -d clb -a -f alter-3.4.0-1.sql<br/>
$ psql -U hibernate -d clb -a -f alter-3.4.0-2.sql<br/>
$ psql -U hibernate -d clb -a -f alter-3.4.0-3.sql</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.3.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.4.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_auth postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/auth/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/auth/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_auth"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/postgresqldb/main</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/postgresqldb/main</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_auth postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/postgresqldb/auth</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/postgresqldb/auth</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_auth"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&lt;ResourceLink global="<font color="red">jdbc/postgresqldb</font>" name="<font color="red">jdbc/postgresqldb</font>" type="javax.sql.DataSource"/><br/>
&lt;ResourceLink global="<font color="red">jdbc/auth/postgresqldb</font>" name="<font color="red">jdbc/auth/postgresqldb</font>" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&lt;ResourceLink global="<font color="red">jdbc/postgresqldb/main</font>" name="<font color="red">jdbc/postgresqldb/main</font>" type="javax.sql.DataSource"/><br/>
&lt;ResourceLink global="<font color="red">jdbc/postgresqldb/auth</font>" name="<font color="red">jdbc/postgresqldb/auth</font>" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows at the ena of the file:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
<br/>
attachment.tmp.clear.rate.millis=3600000<br/>
attachment.tmp.lifetime.seconds=14402<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.3.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.3.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.4.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_auth postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/auth/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/auth/postgresqldb</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_auth"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;!-- PostgreSQL --&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/postgresqldb/main</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/postgresqldb/main</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_auth postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="<font color="red">jdbc/postgresqldb/auth</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="<font color="red">jdbc/postgresqldb/auth</font>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_auth"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:hibernate_password&gt;</font>" /&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&lt;ResourceLink global="<font color="red">jdbc/postgresqldb</font>" name="<font color="red">jdbc/postgresqldb</font>" type="javax.sql.DataSource"/><br/>
&lt;ResourceLink global="<font color="red">jdbc/auth/postgresqldb</font>" name="<font color="red">jdbc/auth/postgresqldb</font>" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br/>
&lt;ResourceLink global="<font color="red">jdbc/postgresqldb/main</font>" name="<font color="red">jdbc/postgresqldb/main</font>" type="javax.sql.DataSource"/><br/>
&lt;ResourceLink global="jdbc/postgresqldb/crdt" name="jdbc/postgresqldb/crdt" type="javax.sql.DataSource"/><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows at the ena of the file:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
<br/>
attachment.tmp.clear.rate.millis=3600000<br/>
attachment.tmp.lifetime.seconds=14402<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis update. Date 2019-09-27</h2>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) add firewall rule for tomcat openwire port for statistics nginx server using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbpngnx02&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) add firewall rule for tomcat openwire port for statistics nginx server using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbpngnx02&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct02:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>
    <h2>Memfis update. Date 2019-09-30</h2>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) remove firewall rule for tomcat openwire port for statistics nginx server using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --remove-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbpngnx02&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct01:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) remove firewall rule for tomcat openwire port for statistics nginx server using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --permanent --zone=public --remove-rich-rule='rule family="ipv4" source address="<font color="red">&lt;external_ip_of_clbpngnx02&gt;</font>/32" port protocol="tcp" port="8000" accept'</code></div></li>
        <li><p>(ssh:clbttmct02:root) reload firewall using the following command:</p>
            <div style="background-color:silver;"><code># firewall-cmd --reload</code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/elasticsearch/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/elasticsearch/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf lib/<br/>
$ rm clb-elasticsearch-datasync-3.1.0-RELEASE.jar<br/></code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/elasticsearch/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-elasticsearch-datasync/elasticsearch-mapping-scripts/alter-3.4.0-1.sh<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/clb-elasticsearch-datasync-3.4.0-RELEASE.jar<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify ~/elasticsearch/alter-3.4.0-1.sh: change <font color="red">127.0.0.1</font> to <font color="red">&lt;external_ip_of_clbtmari01&gt;</font></p></li>
        <li><p>(ssh:clbtmari01:memfis) execute elasticsearch curl script using the following command (<a href="#elasticsearch_elastic_password">requires password for elastic user</a>):</p>
            <div style="background-color:silver;"><code>$ bash ./alter-3.4.0-1.sh</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) the output for this command should be</p>
            <div style="background-color:silver;"><code>$ {"acknowledged":true}</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing projects: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.4.0-RELEASE.jar datasync.properties user</code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-10-03</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.5.0-1.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.5.0-1.sql</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.4.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.5.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>email.feedback</b> property:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
email.owners=<font color="red">&lt;product_owner_email_address1&gt;,&lt;product_owner_email_address2&gt;,...</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.4.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.4.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.5.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>email.feedback</b> property:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br/>
email.owners=<font color="red">&lt;product_owner_email_address1&gt;,&lt;product_owner_email_address2&gt;,...</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-10-04</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) create directory crdt, using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir crdt</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) create directory crdt_backup, using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir crdt_backup</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/crdt/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/_initial-1.sql<br/>
/colaba_back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/_initial-2.sql<br/>
/colaba_back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/_initial-3.sql</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/crdt_backup/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/backup/_initial-1.sql<br/>
/colaba_back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/backup/_initial-2.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) <a id="psql_jdbc_crdt_password">modify <b>/home/memfis/psql/crdt/_initial-1.sql</b></a>:</p>
            <div style="background-color:silver;"><code>>>> START the following line:<br/>
CREATE USER jdbc_crdt WITH ENCRYPTED PASSWORD '121212';<br/>
>>> FINISH<br/></code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /home/memfis/psql/_initial-1.sql:<br/>
CREATE USER jdbc_crdt WITH ENCRYPTED PASSWORD '<font color="red">&lt;actual_password&gt;</font>';<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) <a id="psql_jdbc_main_read_password">modify <b>/home/memfis/psql/crdt/_initial-3.sql</b></a>:</p>
            <div style="background-color:silver;"><code>>>> START the following line:<br/>
CREATE USER jdbc_main_read WITH ENCRYPTED PASSWORD '121212';<br/>
>>> FINISH<br/></code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /home/memfis/psql/_initial-1.sql:<br/>
CREATE USER jdbc_main_read WITH ENCRYPTED PASSWORD '<font color="red">&lt;actual_password&gt;</font>';<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) <a id="psql_jdbc_crdt_b_password">modify <b>/home/memfis/psql/crdt_backup/_initial-1.sql</b></a>:</p>
            <div style="background-color:silver;"><code>>>> START the following line:<br/>
CREATE USER jdbc_crdt_b WITH ENCRYPTED PASSWORD '121212';<br/>
>>> FINISH<br/></code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /home/memfis/psql/_initial-1.sql:<br/>
CREATE USER jdbc_crdt_b WITH ENCRYPTED PASSWORD '<font color="red">&lt;actual_password&gt;</font>';<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_postgres_password">password of postgres</a> user on first step and <a href="#psql_hibernate_password">password for hibernate user</a> on the next commands)</p>
            <div style="background-color:silver;"><code>$ psql -U postgres -a -f crdt/_initial-1.sql<br/>
$ psql -U postgres -d clb_crdt -a -f crdt/_initial-2.sql<br />
$ psql -U postgres -a -f crdt/_initial-3.sql<br />
$ psql -U postgres -a -f crdt_backup/_initial-1.sql<br />
$ psql -U postgres -d clb_crdt_b -a -f crdt_backup/_initial-2.sql</code></div></li>
    </ol>
    <h3>Apache Cassandra</h3>
    <ol>
        <li><p>login <b>clbtcsnd01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) change directory to cql using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/cql/</code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) create directory notif using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir crdt</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/cql/notif/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-crdt-parent/clb-crdt-model/cassandra/_initial.cql</code><br/></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) execute cassandra shell scripts using the following command (requires <a href="#cassandra_clb_superuser_password">password</a>):</p>
            <div style="background-color:silver;"><code>$ cqlsh -u clb_superuser -f crdt/_initial.cql <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
        <li><p>(ssh:clbtcsnd01:memfis) login to cassandra shell with clb_superuser using the following command:</p>
            <div style="background-color:silver;"><code>$ cqlsh -u clb_superuser <font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font></code></div></li>
        <li><p>(cqlsh) <a id="cassandra_clb_crdt_password">create user clb_crdt using the following command</a>:</p>
            <div style="background-color:silver;"><code>cqlsh> CREATE ROLE clb_crdt WITH PASSWORD = '<font color="red">&lt;your_password></font>' AND SUPERUSER = false AND LOGIN = true;<br/>
cqlsh> GRANT SELECT on KEYSPACE clb_crdt_history to clb_crdt;<br/>
cqlsh> GRANT MODIFY on KEYSPACE clb_crdt_history to clb_crdt;</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:dev:memfis) create file <b>/app/tomcat/apache-tomcat-9.0.21/conf/cassandra.crdt.conf</b> with the following content (<a href="#cassandra_clb_crdt_password">requires password</a>):</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/cassandra.crdt.conf<br/>
datastax-java-driver {<br/>
&nbsp;&nbsp;advanced.auth-provider {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;class = PlainTextAuthProvider<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username = clb_crdt<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password = <font color="red">&lt;cassandra:clb_crdt_password></font><br/>
&nbsp;&nbsp;}<br/>
}<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jdbc/postgresqldb/main</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;">
                <code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;Resource <br />
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br />
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br /> &nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br />
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br />
&nbsp;&nbsp;&nbsp;&nbsp;description="clb read-only postgresql connection pool"<br />
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br />
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb/mainread"<br />
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br /> &nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br />
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb/mainread"<br />
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br />
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br />
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br />
&nbsp;&nbsp;&nbsp;&nbsp;username="jdbc_main_read"<br />
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:jdbc_main_read_password&gt;</font>" /&gt;<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jdbc/postgresqldb/auth</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="SERIALIZABLE"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_crdt postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb/crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb/crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="jdbc_crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:jdbc_crdt_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br /> &nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br />
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br /> &nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br />
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br />
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_crdt_b postgresql connection pool"<br />
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br />
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb/crdtb"<br /> &nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br />
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br /> &nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb/crdtb"<br />
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br />
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br />
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_crdt_b"<br />
&nbsp;&nbsp;&nbsp;&nbsp;username="jdbc_crdt_b"<br />
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:jdbc_crdt_b_password&gt;</font>" /&gt;<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>nosql/notif/cassandra/cqlsession</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;">
                <code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;Resource <br />
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br />
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br />
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_crdt_history"<br />
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/crdt/cassandra/cqlsession"<br />
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br />
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br />
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.crdt.conf" /&gt;<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>jdbc/postgresqldb/main</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="jdbc/postgresqldb/mainread" global="jdbc/postgresqldb/mainread" type="javax.sql.DataSource" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>jdbc/postgresqldb/auth</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="jdbc/postgresqldb/crdt" global="jdbc/postgresqldb/crdt" type="javax.sql.DataSource" /><br />
&lt;ResourceLink name="jdbc/postgresqldb/crdtb" global="jdbc/postgresqldb/crdtb" type="javax.sql.DataSource" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>nosql/notif/cassandra/cqlsession</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="nosql/crdt/cassandra/cqlsession" global="nosql/crdt/cassandra/cqlsession" type="com.datastax.oss.driver.api.core.CqlSession" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service restart</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:dev:memfis) create file <b>/app/tomcat/apache-tomcat-9.0.21/conf/cassandra.crdt.conf</b> with the following content (<a href="#cassandra_clb_crdt_password">requires password</a>):</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/cassandra.crdt.conf<br/>
datastax-java-driver {<br/>
&nbsp;&nbsp;advanced.auth-provider {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;class = PlainTextAuthProvider<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username = clb_crdt<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password = <font color="red">&lt;cassandra:clb_crdt_password></font><br/>
&nbsp;&nbsp;}<br/>
}<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jdbc/postgresqldb/main</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;">
                <code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;Resource <br />
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br />
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br /> &nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br />
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="REPEATABLE_READ"<br />
&nbsp;&nbsp;&nbsp;&nbsp;description="clb read-only postgresql connection pool"<br />
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br />
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb/mainread"<br />
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br /> &nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br />
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb/mainread"<br />
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br />
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br />
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb"<br />
&nbsp;&nbsp;&nbsp;&nbsp;username="jdbc_main_read"<br />
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:jdbc_main_read_password&gt;</font>" /&gt;<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jdbc/postgresqldb/auth</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;Resource <br/>
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="SERIALIZABLE"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_crdt postgresql connection pool"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb/crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb/crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username="jdbc_crdt"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:jdbc_crdt_password&gt;</font>" /&gt;<br/>
&nbsp;&nbsp;&lt;Resource <br /> &nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br />
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br /> &nbsp;&nbsp;&nbsp;&nbsp;defaultAutoCommit="true"<br />
&nbsp;&nbsp;&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br />
&nbsp;&nbsp;&nbsp;&nbsp;description="clb_crdt_b postgresql connection pool"<br />
&nbsp;&nbsp;&nbsp;&nbsp;driverClassName="org.postgresql.Driver"<br />
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;global="jdbc/postgresqldb/crdtb"<br /> &nbsp;&nbsp;&nbsp;&nbsp;maxIdle="10"<br />
&nbsp;&nbsp;&nbsp;&nbsp;maxTotal="50"<br /> &nbsp;&nbsp;&nbsp;&nbsp;maxWaitMillis="10000"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="jdbc/postgresqldb/crdtb"<br />
&nbsp;&nbsp;&nbsp;&nbsp;removeAbandonedTimeout="300"<br />
&nbsp;&nbsp;&nbsp;&nbsp;type="javax.sql.DataSource"<br />
&nbsp;&nbsp;&nbsp;&nbsp;url="jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_crdt_b"<br />
&nbsp;&nbsp;&nbsp;&nbsp;username="jdbc_crdt_b"<br />
&nbsp;&nbsp;&nbsp;&nbsp;password="<font color="red">&lt;postgresql:jdbc_crdt_b_password&gt;</font>" /&gt;<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>nosql/notif/cassandra/cqlsession</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;">
                <code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;Resource <br />
&nbsp;&nbsp;&nbsp;&nbsp;auth="Container"<br />
&nbsp;&nbsp;&nbsp;&nbsp;closeMethod="close"<br />
&nbsp;&nbsp;&nbsp;&nbsp;factory="org.wrkr.clb.common.cassandra.CqlSessionFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;keyspace="clb_crdt_history"<br />
&nbsp;&nbsp;&nbsp;&nbsp;localDataCenter="datacenter1"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="nosql/crdt/cassandra/cqlsession"<br />
&nbsp;&nbsp;&nbsp;&nbsp;nodes="<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042"<br />
&nbsp;&nbsp;&nbsp;&nbsp;type="com.datastax.oss.driver.api.core.CqlSession"<br />
&nbsp;&nbsp;&nbsp;&nbsp;applicationConfFile="${sys:catalina.home}/conf/cassandra.crdt.conf" /&gt;<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>jdbc/postgresqldb/main</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="jdbc/postgresqldb/mainread" global="jdbc/postgresqldb/mainread" type="javax.sql.DataSource" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>jdbc/postgresqldb/auth</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="jdbc/postgresqldb/crdt" global="jdbc/postgresqldb/crdt" type="javax.sql.DataSource" /><br />
&lt;ResourceLink name="jdbc/postgresqldb/crdtb" global="jdbc/postgresqldb/crdtb" type="javax.sql.DataSource" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>nosql/notif/cassandra/cqlsession</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="nosql/crdt/cassandra/cqlsession" global="nosql/crdt/cassandra/cqlsession" type="com.datastax.oss.driver.api.core.CqlSession" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service restart</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-10-11</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.6.0-1.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.6.0-1.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtpsql01:root) modify <b>/var/lib/pgsql/data/postgresql.conf</b></p>
            <div style="background-color:silver;"><code>>>> START the following line<br/>
max_connections = <font color="red">100</font> # (change requires restart)<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /var/lib/pgsql/data/postgresql.conf<br/>
max_connections = <font color="red">1000</font> # (change requires restart)<br/>
>>> FINISH</code></div><br/>
and<br/>
<br/>
<div style="background-color:silver;"><code>>>> START the following line<br/>
shared_buffers = <font color="red">32MB</font> # min 128kB<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /var/lib/pgsql/data/postgresql.conf<br/>
shared_buffers = <font color="red">240MB</font> # min 128kB<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtpsql01:root) restart postgresql using the following command</p>
            <div style="background-color:silver;"><code># service postgresql.service restart</code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/elastic-search/elasticsearch-7.1.0/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/elastic-search/elasticsearch-7.1.0/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>config/roles.yml</b>: add the following line:</p>
            <div style="background-color: silver;"><code>>>> START /app/elastic-search/elasticsearch-7.1.0/config/roles.yml<br/>
clb_users:<br/>
&nbsp;&nbsp;run_as: [ 'clb1' ]<br/>
&nbsp;&nbsp;indices:<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color: silver;"><code>>>> START /app/elastic-search/elasticsearch-7.1.0/config/roles.yml<br/>
clb_users:<br/>
&nbsp;&nbsp;run_as: [ 'clb1' ]<br/>
<font color="yellow">&nbsp;&nbsp;cluster: [ 'monitor' ]</font><br/>
&nbsp;&nbsp;indices:<br/>
>>> FINISH</code></div><br/></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtmari01:root) restart elasticsearch using the following command</p>
            <div style="background-color:silver;"><code># service elasticsearch.service restart</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.5.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.6.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jms/ConnectionFactory</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;!-- ActiveMQ Self Check Topic --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/clb.selfcheck"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.selfcheck1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Self Check Queue --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.selfcheck.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.selfcheck1.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">150</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">150</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>jms/ConnectionFactory</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="jms/topic/clb.selfcheck" global="jms/topic/clb.selfcheck" type="org.apache.activemq.command.ActiveMQTopic" /><br />
&lt;ResourceLink name="jms/queue/clb.selfcheck.q" global="jms/queue/clb.selfcheck.q" type="org.apache.activemq.command.ActiveMQQueue" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows at the beginning of the file:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
environment=stage<br />
node.id=1<br />
selfcheck.rate.millis=120000<br />
<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>email.owners</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
email.devops=<font color="red">&lt;devops_email_address1&gt;,&lt;devops_email_address2&gt;,...</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>notif.token.lifetime.seconds</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
crdt.token.notbefore.tolerance.seconds=60<br />
crdt.token.lifetime.seconds=300<br />
<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>dropbox.redirecturi.project</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
recaptcha.client.secret=<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows at the end of the file:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
admin.username=admin<br />
admin.password=<font color="red">&lt;admin_password_hash&gt;</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>log4j2.xml</b>: modify the following rows:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/log4j2.xml<br/>
&nbsp;&nbsp;&lt;Appenders&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Console name="Console" target="SYSTEM_OUT"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout pattern="%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Console&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File" append="true" fileName="${sys:catalina.home}/logs/memfis.log" filePattern="${sys:catalina.home}/logs/memfis.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&lt;/Appenders&gt;<br/>
&nbsp;&nbsp;&lt;Loggers&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Root level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File"/&gt;<br/>
&nbsp;&nbsp;&lt;/Root&gt;<br/>
&nbsp;&nbsp;&lt;/Loggers&gt;<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/log4j2.xml<br/>
&nbsp;&nbsp;&lt;Appenders&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-All" append="true" fileName="${sys:catalina.home}/logs/qirk.log" filePattern="${sys:catalina.home}/logs/qirk.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Common" append="true" fileName="${sys:catalina.home}/logs/qirk-common.log" filePattern="${sys:catalina.home}/logs/qirk-common.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Main" append="true" fileName="${sys:catalina.home}/logs/qirk-main.log" filePattern="${sys:catalina.home}/logs/qirk-main.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Chat" append="true" fileName="${sys:catalina.home}/logs/qirk-chat.log" filePattern="${sys:catalina.home}/logs/qirk-chat.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Stat" append="true" fileName="${sys:catalina.home}/logs/qirk-stat.log" filePattern="${sys:catalina.home}/logs/qirk-stat.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Notif" append="true" fileName="${sys:catalina.home}/logs/qirk-notif.log" filePattern="${sys:catalina.home}/logs/qirk-notif.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Crdt" append="true" fileName="${sys:catalina.home}/logs/qirk-crdt.log" filePattern="${sys:catalina.home}/logs/qirk-crdt.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Admin" append="true" fileName="${sys:catalina.home}/logs/qirk-admin.log" filePattern="${sys:catalina.home}/logs/qirk-admin.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&lt;/Appenders&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;Loggers&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Root level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-All"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Root&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.model" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.repo" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.services" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.web" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.common" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Common"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.chat" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Chat"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.statistics" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Stat"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.notification" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Notif"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.crdt" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Crdt"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.admin" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Admin"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&lt;/Loggers&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.5.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.5.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.6.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>jms/ConnectionFactory</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;!-- ActiveMQ Self Check Topic --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/topic/clb.selfcheck"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.selfcheck2"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQTopic" /><br/>
<br/>
&nbsp;&nbsp;&lt;!-- ActiveMQ Self Check Queue --><br/>
&nbsp;&nbsp;&lt;Resource auth="Container" factory="org.apache.activemq.jndi.JNDIReferenceFactory"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;name="jms/queue/clb.selfcheck.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;physicalName="clb.selfcheck2.q"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;type="org.apache.activemq.command.ActiveMQQueue" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">250</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&lt;!-- MariaDB --><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_COMMITTED"<br/>
&nbsp;&nbsp;description="clb_chat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">150</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
&lt;Resource<br/>
&nbsp;&nbsp;auth="Container"<br/>
&nbsp;&nbsp;closeMethod="close"<br/>
&nbsp;&nbsp;defaultAutoCommit="true"<br/>
&nbsp;&nbsp;defaultTransactionIsolation="READ_UNCOMMITTED"<br/>
&nbsp;&nbsp;description="clb_stat mariadb connection pool"<br/>
&nbsp;&nbsp;driverClassName="org.mariadb.jdbc.Driver"<br/>
&nbsp;&nbsp;factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"<br/>
&nbsp;&nbsp;global="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;maxIdle="50"<br/>
&nbsp;&nbsp;maxTotal="<font color="red">150</font>"<br/>
&nbsp;&nbsp;maxWaitMillis="10000"<br/>
&nbsp;&nbsp;name="jdbc/stat/mariadb"<br/>
&nbsp;&nbsp;removeAbandonedTimeout="300"<br/>
&nbsp;&nbsp;testOnBorrow="true"<br/>
&nbsp;&nbsp;validationQuery="SELECT 1"<br/>
&nbsp;&nbsp;type="javax.sql.DataSource"<br/>
&nbsp;&nbsp;url="jdbc:mysql://<font color="red">&lt;external_ip_of_clbtmari01></font>:3306/clb_stat"<br/>
&nbsp;&nbsp;username="hibernate"<br/>
&nbsp;&nbsp;password="<font color="red">&lt;mariadb:hibernate_password></font>" /><br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>jms/ConnectionFactory</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="jms/topic/clb.selfcheck" global="jms/topic/clb.selfcheck" type="org.apache.activemq.command.ActiveMQTopic" /><br />
&lt;ResourceLink name="jms/queue/clb.selfcheck.q" global="jms/queue/clb.selfcheck.q" type="org.apache.activemq.command.ActiveMQQueue" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows at the beginning of the file:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
environment=stage<br />
node.id=2<br />
selfcheck.rate.millis=120000<br />
<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>email.owners</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
email.devops=<font color="red">&lt;devops_email_address1&gt;,&lt;devops_email_address2&gt;,...</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>notif.token.lifetime.seconds</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
crdt.token.notbefore.tolerance.seconds=60<br />
crdt.token.lifetime.seconds=300<br />
<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>dropbox.redirecturi.project</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
recaptcha.client.secret=<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows at the end of the file:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
admin.username=admin<br />
admin.password=<font color="red">&lt;admin_password_hash&gt;</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>log4j2.xml</b>: modify the following rows:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/log4j2.xml<br/>
&nbsp;&nbsp;&lt;Appenders&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Console name="Console" target="SYSTEM_OUT"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout pattern="%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Console&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File" append="true" fileName="${sys:catalina.home}/logs/memfis.log" filePattern="${sys:catalina.home}/logs/memfis.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&lt;/Appenders&gt;<br/>
&nbsp;&nbsp;&lt;Loggers&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Root level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File"/&gt;<br/>
&nbsp;&nbsp;&lt;/Root&gt;<br/>
&nbsp;&nbsp;&lt;/Loggers&gt;<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/log4j2.xml<br/>
&nbsp;&nbsp;&lt;Appenders&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-All" append="true" fileName="${sys:catalina.home}/logs/qirk.log" filePattern="${sys:catalina.home}/logs/qirk.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Common" append="true" fileName="${sys:catalina.home}/logs/qirk-common.log" filePattern="${sys:catalina.home}/logs/qirk-common.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Main" append="true" fileName="${sys:catalina.home}/logs/qirk-main.log" filePattern="${sys:catalina.home}/logs/qirk-main.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Chat" append="true" fileName="${sys:catalina.home}/logs/qirk-chat.log" filePattern="${sys:catalina.home}/logs/qirk-chat.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Stat" append="true" fileName="${sys:catalina.home}/logs/qirk-stat.log" filePattern="${sys:catalina.home}/logs/qirk-stat.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Notif" append="true" fileName="${sys:catalina.home}/logs/qirk-notif.log" filePattern="${sys:catalina.home}/logs/qirk-notif.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Crdt" append="true" fileName="${sys:catalina.home}/logs/qirk-crdt.log" filePattern="${sys:catalina.home}/logs/qirk-crdt.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollingFile name="File-Admin" append="true" fileName="${sys:catalina.home}/logs/qirk-admin.log" filePattern="${sys:catalina.home}/logs/qirk-admin.%d{yyyy-MM-dd_HH-mm-ss}.%i.log"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Pattern&gt;%d{dd MMM yyyy HH:mm:ss.SSS} %-5level [%t] %logger{36}:%L - %msg%n&lt;/Pattern&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SizeBasedTriggeringPolicy size="50 MB" /&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Policies&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;<br/>
&nbsp;&nbsp;&lt;/Appenders&gt;<br/>
<br/>
&nbsp;&nbsp;&lt;Loggers&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Root level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-All"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Root&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.model" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.repo" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.services" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.web" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Main"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.common" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Common"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.chat" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Chat"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.statistics" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Stat"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.notification" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Notif"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.crdt" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Crdt"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Logger name="org.wrkr.clb.admin" level="info"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef ref="File-Admin"/&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Logger&gt;<br/>
&nbsp;&nbsp;&lt;/Loggers&gt;<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-10-15</h2>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.6.0-1.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute <b>stat/alter-3.6.0-1.sql</b> using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.6.0-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to /home/memfis/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create directory crdt-datasync using the following command:</p>
            <div style="background-color:silver;"><code>$ mkdir crdt-datasync</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to /home/memfis/crdt-datasync/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/crdt-datasync/</code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/crdt-datasync/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-crdt-parent/clb-crdt-datasync/target/clb-crdt-datasync-3.6.0-RELEASE.jar<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create file <b>datasync.properties</b> with the following content (requires <a href="#psql_hibernate_password">postgresql:hibernate</a> and <a href="#elasticsearch_clb1_password">elasticsearch:clb1</a> passwords):</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/crdt-datasync/datasync.properties<br/>
database.main.url=jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb<br/>
database.main.username=jdbc_main_read<br/>
database.main.password=<font color="red">&lt;postgresql:jdbc_main_read_password&gt;</font><br/>
<br/>
database.crdt.url=jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_crdt<br/>
database.crdt.username=jdbc_crdt<br/>
database.crdt.password=<font color="red">&lt;postgresql:jdbc_crdt_password&gt;</font><br/>
<br/>
database.crdtbackup.url=jdbc:postgresql://<font color="red">&lt;external_ip_of_clbtpsql01&gt;</font>:5432/clb_crdt_b<br/>
database.crdtbackup.username=jdbc_crdt_b<br/>
database.crdtbackup.password=<font color="red">&lt;postgresql:jdbc_crdt_b_password&gt;</font><br/>
<br/>
database.crdthistory.nodes=<font color="red">&lt;external_ip_of_clbtcsnd01&gt;</font>:9042<br/>
database.crdthistory.keyspace=clb_crdt_history<br/>
database.crdthistory.localdc=datacenter1<br/>
database.crdthistory.propfile=/home/memfis/crdt-datasync/cassandra.conf<br/>
<br/>
email.host=<font color="red">&lt;smpt_host&gt;</font><br/>
email.port=587<br/>
email.host.user=<font color="red">&lt;email_account&gt;</font><br/>
email.host.password=<font color="red">&lt;email_password&gt;</font><br/>
email.from=<font color="red">&lt;email_from&gt;</font><br/>
email.owners=<font color="red">&lt;product_owner_email_address1&gt;,&lt;product_owner_email_address2&gt;,...</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) create file <b>/home/memfis/crdt-datasync/cassandra.conf</b> with the following content (<a href="#cassandra_clb1_password">requires password</a>):</p>
            <div style="background-color:silver;"><code>>>> START /home/memfis/crdt-datasync/cassandra.conf<br/>
datastax-java-driver {<br/>
&nbsp;&nbsp;advanced.auth-provider {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;class = PlainTextAuthProvider<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;username = clb_crdt<br/>
&nbsp;&nbsp;&nbsp;&nbsp;password = <font color="red">&lt;cassandra:clb_crdt_password></font><br/>
&nbsp;&nbsp;}<br/>
}<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command:</p>
            <div style="background-color:silver;"><code>$ java -jar clb-crdt-datasync-3.6.0-RELEASE.jar datasync.properties</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-10-18</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.7.0-1.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.7.0-1.sql</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to <b>/app/elastic-search/elasticsearch-7.1.0/config/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/elastic-search/elasticsearch-7.1.0/config/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>roles.yml</b>: modify following rows:</p>
            <div style="background-color:silver;"><code>>>> START /app/elastic-search/elasticsearch-7.1.0/config/roles.yml<br/>
- names: [ 'user', 'organization', 'project' ]<br/>
>>> FINISH</code></div><br/>
to<br/>
<br/>
<div style="background-color:silver;"><code>>>> START /app/elastic-search/elasticsearch-7.1.0/config/roles.yml<br/>
- names: [ 'user', 'organization', 'project'<font color="red">, 'task'</font> ]<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/elasticsearch/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/elasticsearch/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf lib/<br/>
$ rm clb-elasticsearch-datasync-3.4.0-RELEASE.jar<br/></code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/elasticsearch/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-elasticsearch-datasync/elasticsearch-mapping-scripts/alter-3.7.0-1.sh<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/clb-elasticsearch-datasync-3.7.0-RELEASE.jar<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>~/elasticsearch/alter-3.7.0-1.sh</b>: change <font color="red">127.0.0.1</font> to <font color="red">&lt;external_ip_of_clbtmari01&gt;</font></p></li>
        <li><p>(ssh:clbtmari01:memfis) execute elasticsearch curl script using the following command (<a href="#elasticsearch_elastic_password">requires password for elastic user</a>):</p>
            <div style="background-color:silver;"><code>$ bash ./alter-3.7.0-1.sh</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) the output for this command should be</p>
            <div style="background-color:silver;"><code>$ {"acknowledged":true}</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing tasks: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.7.0-RELEASE.jar datasync.properties</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbtmari01:root) restart elasticsearch using the following command</p>
            <div style="background-color:silver;"><code># service elasticsearch.service restart</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.6.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.7.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:dev:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right before</font> <b>notif.list.limit</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
task.list.limit=42<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.6.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.6.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.7.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:dev:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right before</font> <b>notif.list.limit</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
task.list.limit=42<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis fix. Date 2019-10-21</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-model/psql/alter-3.7.0-2.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.7.0-2.sql</code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-10-26</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/crdt/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/alter-3.8.0-1.sql<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/alter-3.8.0-2.sql<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/alter-3.8.0-3.sql</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.8.0-1.sql<br/>
/back/clb-parent/clb-main-parent/clb-model/psql/set-license-not-accepted.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_postgres_password">password for postgres user</a> and <a href="#psql_hibernate_password">password for hibernate user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U postgres -d clb_crdt -a -f crdt/alter-3.8.0-1.sql<br/>
$ psql -U postgres -d clb -a -f crdt/alter-3.8.0-2.sql<br/>
$ psql -U postgres -d clb_crdt -a -f crdt/alter-3.8.0-3.sql<br/>
$ psql -U hibernate -d clb -a -f alter-3.8.0-1.sql<br/>
$ psql -U hibernate -d clb -a -f set-license-not-accepted.sql</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/elasticsearch/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/elasticsearch/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf lib/<br/>
$ rm clb-elasticsearch-datasync-3.7.0-RELEASE.jar<br/></code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/elasticsearch/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-elasticsearch-datasync/elasticsearch-mapping-scripts/alter-3.8.0-1.sh<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/clb-elasticsearch-datasync-3.8.0-RELEASE.jar<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>~/elasticsearch/alter-3.8.0-1.sh</b>: change <font color="red">127.0.0.1</font> to <font color="red">&lt;external_ip_of_clbtmari01&gt;</font></p></li>
        <li><p>(ssh:clbtmari01:memfis) execute elasticsearch curl script using the following command (<a href="#elasticsearch_elastic_password">requires password for elastic user</a>):</p>
            <div style="background-color:silver;"><code>$ bash ./alter-3.8.0-1.sh</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) the output for this command should be</p>
            <div style="background-color:silver;"><code>$ {"acknowledged":true}</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing tasks: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.8.0-RELEASE.jar datasync.properties task</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.7.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.8.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>elasticsearch/client</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;!-- Yandexcloud Storage --><br />
&nbsp;&nbsp;&lt;Resource auth="Container" closeMethod="close" factory="org.wrkr.clb.common.amazonaws.AmazonS3ClientFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="yandexcloud/client/storage" singleton="true" type="com.amazonaws.services.s3.AmazonS3"<br />
&nbsp;&nbsp;&nbsp;&nbsp;accessKey="<font color="red">&lt;yandexcloud_access_key_id></font>"<br />
&nbsp;&nbsp;&nbsp;&nbsp;secretKey="<font color="red">&lt;yandexcloud_secret_access_key></font>"<br />
&nbsp;&nbsp;&nbsp;&nbsp;storageUrl="storage.yandexcloud.net" region="ru-central1" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>elasticsearch/client</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="yandexcloud/client/storage" global="yandexcloud/client/storage" type="com.amazonaws.services.s3.AmazonS3" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:dev:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right before</font> <b>dropbox.redirecturi.project</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
yandexcloud.bucket.name=<font color="red">&lt;bucket_name></font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:dev:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right before</font> <b>recaptcha.client.secret</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
cloudpayments.client.id=<font color="red">&lt;cloudpayments_public_ID></font><br />
cloudpayments.client.secret=<font color="red">&lt;cloudpayments_api_secret></font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
recaptcha.client.secret=<br />
>>> FINISH</code></div><br />
to<br />
<br />
<div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
recaptcha.client.secret=<font color="red">&lt;grecaptcha_secret&gt;</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-cassandra-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-elasticsearch-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jms-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-logging-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-sql-3.7.0-RELEASE-jar-with-dependencies.jar<br/>
$ rm clb-common-deps-jackson-3.7.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.8.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.8.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: add the following text <font color="red">right after</font> configuring of <b>elasticsearch/client</b> (inside <b>/Server/GlobalNamingResource</b> element)</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br />
&nbsp;&nbsp;&lt;!-- Yandexcloud Storage --><br />
&nbsp;&nbsp;&lt;Resource auth="Container" closeMethod="close" factory="org.wrkr.clb.common.amazonaws.AmazonS3ClientFactory"<br />
&nbsp;&nbsp;&nbsp;&nbsp;name="yandexcloud/client/storage" singleton="true" type="com.amazonaws.services.s3.AmazonS3"<br />
&nbsp;&nbsp;&nbsp;&nbsp;accessKey="<font color="red">&lt;yandexcloud_access_key_id></font>"<br />
&nbsp;&nbsp;&nbsp;&nbsp;secretKey="<font color="red">&lt;yandexcloud_secret_access_key></font>"<br />
&nbsp;&nbsp;&nbsp;&nbsp;storageUrl="storage.yandexcloud.net" region="ru-central1" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>context.xml</b>: add the following text <font color="red">right after</font> <b>elasticsearch/client</b> resource:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/context.xml<br />
&lt;ResourceLink name="yandexcloud/client/storage" global="yandexcloud/client/storage" type="com.amazonaws.services.s3.AmazonS3" /><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:dev:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right before</font> <b>dropbox.redirecturi.project</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
yandexcloud.bucket.name=<font color="red">&lt;bucket_name></font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:dev:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right before</font> <b>recaptcha.client.secret</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
<br />
cloudpayments.client.id=<font color="red">&lt;cloudpayments_public_ID></font><br />
cloudpayments.client.secret=<font color="red">&lt;cloudpayments_api_secret></font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: modify following rows:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
recaptcha.client.secret=<br />
>>> FINISH</code></div><br />
to<br />
<br />
<div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
recaptcha.client.secret=<font color="red">&lt;grecaptcha_secret&gt;</font><br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-11-04</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/crdt/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/alter-3.9.0-1.sql</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.9.0-1.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a> and <a href="#psql_postgres_password">password for postgres user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.9.0-1.sql<br/>
$ psql -U postgres -d clb -a -f crdt/alter-3.9.0-1.sql</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.9.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.9.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.9.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-11-07</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following files to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.10.0-1.sql<br/>
/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.10.0-2.sql<br/>
/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.10.0-3.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following commands to setup postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a> and <a href="#psql_postgres_password">password for postgres user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.10.0-1.sql<br/>
$ psql -U hibernate -d clb -a -f alter-3.10.0-2.sql<br/>
$ psql -U hibernate -d clb -a -f alter-3.10.0-3.sql</code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.10.0-1.sql<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.10.0-2.sql</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute mysql scripts using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.10.0-2.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.10.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>rememberme.token.lifetime.seconds</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
max.failed.login.attempts=2<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/bin/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/bin/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>setenv.sh</b>: add following rows at the end of the file:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/bin/setenv.sh<br />
JAVA_OPTS="$JAVA_OPTS -Xmx300m"<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.10.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.10.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>rememberme.token.lifetime.seconds</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
max.failed.login.attempts=2<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/bin/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/bin/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>setenv.sh</b>: add following rows at the end of the file:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/bin/setenv.sh<br />
JAVA_OPTS="$JAVA_OPTS -Xmx300m"<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-11-26</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.11.0-1.sql</code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/psql/crdt/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/alter-3.11.0-1.sql<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/alter-3.11.0-2.sql</code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/psql/crdt_backup/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/backup/alter-3.8.0-1.sql<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/backup/alter-3.11.0-1.sql<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-model/psql/backup/alter-3.11.0-2.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following command to update postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a> and <a href="#psql_postgres_password">password for postgres user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.11.0-1.sql<br/>
$ psql -U postgres -d clb_crdt -a -f crdt/alter-3.11.0-1.sql<br/>
$ psql -U postgres -d clb_crdt -a -f crdt/alter-3.11.0-2.sql<br/>
$ psql -U postgres -d clb_crdt_b -a -f crdt_backup/alter-3.8.0-1.sql<br/>
$ psql -U postgres -d clb_crdt_b -a -f crdt_backup/alter-3.11.0-1.sql<br/>
$ psql -U postgres -d clb_crdt_b -a -f crdt_backup/alter-3.11.0-2.sql</code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
         <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.11.0-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute mysql scripts using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.11.0-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.11.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>cloudpayments.client.secret</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
cloudpayments.url=https://api.cloudpayments.ru/payments/get<br />
<br />
rarus.api.key=<br />
rarus.tax.system=USN<br />
rarus.inn=<br />
rarus.payment.address=https://stage.memfis.org/<br />
rarus.item.name=Service<br />
<br />
checkcycle.rate.millis=300000<br />
checkcycle.max.inactivity.seconds=420<br />
checkcycle.last.activity.seconds=120<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Connector port="8000"<br/>
>>> FINISH<br/></code></div><br/>
to<br/>
<br/>
<div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Connector port="8000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;bindOnInit="true"<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload the following files that appears after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-common/clb-common-deps-amazonaws/target/clb-common-deps-amazonaws-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-cassandra/target/clb-common-deps-cassandra-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-elasticsearch/target/clb-common-deps-elasticsearch-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jms/target/clb-common-deps-jms-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-logging/target/clb-common-deps-logging-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-sql/target/clb-common-deps-sql-3.11.0-RELEASE-jar-with-dependencies.jar<br/>
/back/clb-parent/clb-common/clb-common-deps-jackson/target/clb-common-deps-jackson-3.11.0-RELEASE-jar-with-dependencies.jar</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>cloudpayments.client.secret</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
cloudpayments.url=https://api.cloudpayments.ru/payments/get<br />
<br />
rarus.api.key=<br />
rarus.tax.system=USN<br />
rarus.inn=<br />
rarus.payment.address=https://stage.memfis.org/<br />
rarus.item.name=Service<br />
<br />
checkcycle.rate.millis=300000<br />
checkcycle.max.inactivity.seconds=420<br />
checkcycle.last.activity.seconds=120<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify <b>server.xml</b>: modify following rows:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Connector port="8000"<br/>
>>> FINISH<br/></code></div><br/>
to<br/>
<br/>
<div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/server.xml<br/>
&nbsp;&nbsp;&lt;Connector port="8000"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;bindOnInit="true"<br/>
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-12-05</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.12.0-1.sql<br>
/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.12.0-2.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following command to update postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a> and <a href="#psql_postgres_password">password for postgres user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.12.0-1.sql<br>
$ psql -U hibernate -d clb -a -f alter-3.12.0-2.sql</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Elastic Search</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) change directory to /home/memfis/elasticsearch/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/elasticsearch/</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf lib/<br/>
$ rm clb-elasticsearch-datasync-3.8.0-RELEASE.jar<br/></code></div></li>
        <li><p>from bitbucket repo upload the following files and directories to <b>/home/memfis/elasticsearch/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/colaba_back/clb-parent/clb-elasticsearch-datasync/elasticsearch-mapping-scripts/alter-3.12.0-1.sh<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/clb-elasticsearch-datasync-3.12.0-RELEASE.jar<br/>
/colaba_back/clb-parent/clb-elasticsearch-datasync/target/lib/<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) modify <b>~/elasticsearch/alter-3.12.0-1.sh</b>: change <font color="red">127.0.0.1</font> to <font color="red">&lt;external_ip_of_clbtmari01&gt;</font></p></li>
        <li><p>(ssh:clbtmari01:memfis) execute elasticsearch curl script using the following command (<a href="#elasticsearch_elastic_password">requires password for elastic user</a>):</p>
            <div style="background-color:silver;"><code>$ bash ./alter-3.12.0-1.sh</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) the output for this command should be</p>
            <div style="background-color:silver;"><code>$ {"acknowledged":true}</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing projects: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.12.0-RELEASE.jar datasync.properties project</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing tasks: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.12.0-RELEASE.jar datasync.properties task</code></div></li>
        <li><p>(ssh:clbtmari01:memfis) execute script to synchronize elasticsearch with PostreSQL data using the following command (press Ctrl+C after <b>Synchronizing users: finish</b> log):</p>
            <div style="background-color:silver;"><code>$ java -jar clb-elasticsearch-datasync-3.12.0-RELEASE.jar datasync.properties user</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload all jar with dependencies files from clb-common project that appear after build of local copy of clb to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b></p></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload all jar with dependencies files from clb-common project that appear after build of local copy of clb to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b></p></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h2>Memfis upgrade. Date 2019-12-10</h2>
    <h3>PostgreSQL</h3>
    <ol>
        <li><p>login <b>clbtpsql01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) change directory to /home/memfis/psql/ using the following command:</p>
            <div style="background-color:silver;"><code>$ cd ~/psql/</code></div></li>
        <li><p>from bitbucket repo upload the following file to <b>/home/memfis/psql/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-main-parent/clb-model/psql/alter-3.13.0-1.sql</code></div></li>
        <li><p>(ssh:clbtpsql01:memfis) execute the following command to update postgresql database (requires <a href="#psql_hibernate_password">password for hibernate user</a> and <a href="#psql_postgres_password">password for postgres user</a>)</p>
            <div style="background-color:silver;"><code>$ psql -U hibernate -d clb -a -f alter-3.13.0-1.sql</code></div></li>
    </ol>
    <h3>MariaDB</h3>
    <ol>
        <li><p>login <b>clbtmari01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>
         <li><p>from bitbucket repo upload the following file to <b>/home/memfis/mysql/stat/</b> directory using any sftp client:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-statistics-parent/clb-statistics-repo/mysql/alter-3.13.0-1.sql<br/></code></div></li>
        <li><p>(ssh:clbtmari01:memfis) login to mariadb shell using the following command (requires <a href="#maria_memfis_password">password</a>)</p>
            <div style="background-color:silver;"><code>$ mysql -u memfis -p</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) change database to clb_stat using the following command</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> \r clb_stat</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) execute mysql scripts using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> source /home/memfis/mysql/stat/alter-3.13.0-1.sql</code></div></li>
        <li><p>(mysql:clbtmari01:memfis) exit from mariadb shell using the following command:</p>
            <div style="background-color:silver;"><code>MariaDB [(none)]> exit;</code></div></li>
    </ol>
    <h3>Build CLB</h3>
    <ol>
        <li><p>build clb-parent using the following command inside the directory:</p>
            <div style="background-color:silver;"><code>mvn clean install</code></div></li>
    </ol>
    <h3>Tomcat #01</h3>
    <ol>
        <li><p>login <b>clbttmct01</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct01:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload all jar with dependencies files from clb-common project that appear after build of local copy of clb to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b></p></li>
        <li><p>(ssh:clbttmct01:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.decline.invite</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
front.url.manage.subscriptions=/manage-subscriptions/<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct01:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct01:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct01:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>
    <h3>Tomcat #02</h3>
    <ol>
        <li><p>login <b>clbttmct02</b> box via ssh using <b>memfis</b> account</p>
            <div style="background-color:silver;"><code></code></div></li>   
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) shutdown tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service stop</code></div></li>
        <li><p>(ssh:clbttmct02:root) logout from the root account</p>
            <div style="background-color:silver;"><code># exit</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/webapps/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete all files and directories using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
$ rm -rf clb-chat-web/<br/>
$ rm -rf clb-crdt-web/<br/>
$ rm -rf clb-notification-web/<br/>
$ rm -rf clb-statistics-web/<br/>
$ rm -rf clb-web/<br/>
$ rm clb-admin-web.war<br/>
$ rm clb-chat-web.war<br/>
$ rm clb-crdt-web.war<br/>
$ rm clb-notification-web.war<br/>
$ rm clb-statistics-web.war<br/>
$ rm clb-web.war<br/></code></div></li>
        <li><p>upload the following files that appear after build of local copy of colaba_back to <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>/back/clb-parent/clb-admin-parent/clb-admin-web/target/clb-admin-web.war<br/>
/back/clb-parent/clb-chat-parent/clb-chat-web/target/clb-chat-web.war<br/>
/back/clb-parent/clb-crdt-parent/clb-crdt-web/target/clb-crdt-web.war<br/>
/back/clb-parent/clb-notification-parent/clb-notification-web/target/clb-notification-web.war<br/>
/back/clb-parent/clb-statistics-parent/clb-statistics-web/target/clb-statistics-web.war<br/>
/back/clb-parent/clb-web/target/clb-web.war<br/></code></div></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/lib/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) delete following files using the following commands:</p>
            <div style="background-color:silver;"><code>$ rm clb-common-deps-*-jar-with-dependencies.jar</code></div></li>
        <li><p>upload all jar with dependencies files from clb-common project that appear after build of local copy of clb to <b>/app/tomcat/apache-tomcat-9.0.21/lib/</b></p></li>
        <li><p>(ssh:clbttmct02:memfis) change directory to <b>/app/tomcat/apache-tomcat-9.0.21/conf/</b> using the following command:</p>
            <div style="background-color:silver;"><code>$ cd /app/tomcat/apache-tomcat-9.0.21/conf/</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) modify file <b>common.properties</b>: add following rows <font color="red">right after</font> <b>front.url.decline.invite</b> property:</p>
            <div style="background-color: silver;"><code>>>> START /app/tomcat/apache-tomcat-9.0.21/conf/common.properties<br />
front.url.manage.subscriptions=/manage-subscriptions/<br />
>>> FINISH</code></div></li>
        <li><p>(ssh:clbttmct02:memfis) switch to the root account</p>
            <div style="background-color:silver;"><code>$ su</code></div></li>
        <li><p>(ssh:clbttmct02:root) restart tomcat using the following command</p>
            <div style="background-color:silver;"><code># service tomcat.service start</code></div></li>
        <li><p>(ssh:clbttmct02:root) check logs of clb until the app will be completely started</p>
            <div style="background-color:silver;"><code></code></div></li>
    </ol>

    <h2>Hints</h2>
    <ul>
        <li><p>to delete all files and directories from <b>/app/tomcat/apache-tomcat-9.0.21/webapps/</b>:</p>
            <div style="background-color:silver;"><code>$ rm -rf clb-admin-web/<br/>
rm -rf clb-chat-web/<br/>
rm -rf clb-crdt-web/<br/>
rm -rf clb-notification-web/<br/>
rm -rf clb-statistics-web/<br/>
rm -rf clb-web/<br/>
rm clb-admin-web.war<br/>
rm clb-chat-web.war<br/>
rm clb-crdt-web.war<br/>
rm clb-notification-web.war<br/>
rm clb-statistics-web.war<br/>
rm clb-web.war<br/></code></div></li>
    </ul>

</body>
</html>
